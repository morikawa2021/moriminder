# Moriminder è©³ç´°ä»•æ§˜æ›¸ï¼ˆè¨­è¨ˆæ›¸ï¼‰

## 1. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæƒ…å ±

### 1.1 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¦‚è¦
æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Moriminderï¼ˆãƒ¢ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ï¼‰ã®è¦æ±‚ä»•æ§˜æ›¸ã«åŸºã¥ã„ã¦ä½œæˆã•ã‚ŒãŸè©³ç´°ä»•æ§˜æ›¸ï¼ˆè¨­è¨ˆæ›¸ï¼‰ã§ã™ã€‚ã‚·ã‚¹ãƒ†ãƒ ã®æŠ€è¡“çš„ãªè¨­è¨ˆã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€å®Ÿè£…è©³ç´°ã‚’å®šç¾©ã—ã¾ã™ã€‚

### 1.2 ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ | å¤‰æ›´è€… |
|-----------|------|---------|--------|
| 1.0 | 2025-11-09 02:23 | åˆç‰ˆä½œæˆ | - |

### 1.3 é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- è¦æ±‚ä»•æ§˜æ›¸.md

---

## 2. ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 2.1 å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### 2.1.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³
- **ãƒ‘ã‚¿ãƒ¼ãƒ³**: MVVMï¼ˆModel-View-ViewModelï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³
- **ç†ç”±**: SwiftUIã¨ã®è¦ªå’Œæ€§ãŒé«˜ãã€ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã¨ä¿å®ˆæ€§ã‚’ç¢ºä¿

#### 2.1.2 ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Presentation Layer          â”‚
â”‚  (Views, ViewModels, ViewModifiers) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Business Logic Layer       â”‚
â”‚  (UseCases, Services, Managers)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Data Layer                 â”‚
â”‚  (Repositories, DataSources)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Persistence Layer          â”‚
â”‚  (Core Data / SwiftData)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 2.2.1 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¸€è¦§
1. **TaskManager**: ã‚¿ã‚¹ã‚¯ã®CRUDæ“ä½œã‚’ç®¡ç†
2. **NotificationManager**: é€šçŸ¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã¨ç®¡ç†
3. **ReminderService**: ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè¡Œ
4. **AlarmService**: ã‚¢ãƒ©ãƒ¼ãƒ ã®ç®¡ç†
5. **CategoryManager**: ã‚«ãƒ†ã‚´ãƒªã®ç®¡ç†
6. **TaskSubdivisionService**: ã‚¿ã‚¹ã‚¯ç´°åˆ†åŒ–æ©Ÿèƒ½ï¼ˆLLM APIé€£æºï¼‰
7. **NaturalLanguageParser**: è‡ªç„¶è¨€èªã‹ã‚‰ã®æ—¥æ™‚æŠ½å‡º
8. **RepeatingTaskGenerator**: ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã®ç”Ÿæˆ

---

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ

### 3.1 ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£è¨­è¨ˆ

#### 3.1.1 Taskï¼ˆã‚¿ã‚¹ã‚¯ï¼‰
```swift
class Task: NSManagedObject {
    // åŸºæœ¬æƒ…å ±
    @NSManaged var id: UUID
    @NSManaged var title: String              // ã‚¿ã‚¹ã‚¯åï¼ˆå¿…é ˆï¼‰
    @NSManaged var createdAt: Date            // ç™»éŒ²æ—¥æ™‚
    @NSManaged var completedAt: Date?         // å®Œäº†æ—¥æ™‚
    
    // åˆ†é¡
    @NSManaged var category: Category?        // ã‚«ãƒ†ã‚´ãƒªï¼ˆä»»æ„ï¼‰
    @NSManaged var priority: Priority         // é‡è¦åº¦ï¼ˆä½/ä¸­/é«˜ï¼‰
    
    // æ—¥æ™‚è¨­å®š
    @NSManaged var taskType: TaskType         // ã‚¿ã‚¹ã‚¯/ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
    @NSManaged var deadline: Date?            // æœŸé™ï¼ˆã‚¿ã‚¹ã‚¯ã®å ´åˆï¼‰
    @NSManaged var startDateTime: Date?       // é–‹å§‹æ—¥æ™‚ï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å ´åˆï¼‰
    
    // é€šçŸ¥è¨­å®š
    @NSManaged var alarmDateTime: Date?       // ã‚¢ãƒ©ãƒ¼ãƒ æ™‚åˆ»
    @NSManaged var alarmSound: String?        // ã‚¢ãƒ©ãƒ¼ãƒ éŸ³
    @NSManaged var alarmEnabled: Bool         // ã‚¢ãƒ©ãƒ¼ãƒ æœ‰åŠ¹/ç„¡åŠ¹
    
    // ãƒªãƒã‚¤ãƒ³ãƒ‰è¨­å®š
    @NSManaged var reminderEnabled: Bool      // ãƒªãƒã‚¤ãƒ³ãƒ‰æœ‰åŠ¹/ç„¡åŠ¹
    @NSManaged var reminderInterval: Int      // ãƒªãƒã‚¤ãƒ³ãƒ‰é–“éš”ï¼ˆåˆ†ï¼‰
    @NSManaged var reminderStartTime: Date?   // ãƒªãƒã‚¤ãƒ³ãƒ‰é–‹å§‹æ™‚åˆ»
    @NSManaged var reminderEndTime: Date?     // ãƒªãƒã‚¤ãƒ³ãƒ‰çµ‚äº†æ™‚åˆ»
    @NSManaged var snoozeMaxCount: Int        // ã‚¹ãƒŒãƒ¼ã‚ºæœ€å¤§å›æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5ã€æœ€å¤§10ï¼‰
    @NSManaged var snoozeUnlimited: Bool      // ç„¡æœŸé™ã‚¹ãƒŒãƒ¼ã‚ºï¼ˆæœŸé™è¶…éæ™‚ï¼‰
    @NSManaged var snoozeCount: Int           // ç¾åœ¨ã®ã‚¹ãƒŒãƒ¼ã‚ºå›æ•°
    @NSManaged var lastSnoozeDateTime: Date?  // æœ€å¾Œã®ã‚¹ãƒŒãƒ¼ã‚ºæ—¥æ™‚ï¼ˆãƒªã‚»ãƒƒãƒˆåˆ¤å®šç”¨ï¼‰
    
    // ç¹°ã‚Šè¿”ã—è¨­å®š
    @NSManaged var isRepeating: Bool          // ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã‹ã©ã†ã‹
    @NSManaged var repeatPattern: RepeatPattern? // ç¹°ã‚Šè¿”ã—ãƒ‘ã‚¿ãƒ¼ãƒ³
    @NSManaged var repeatEndDate: Date?       // ç¹°ã‚Šè¿”ã—çµ‚äº†æ—¥æ™‚
    @NSManaged var parentTaskId: UUID?         // è¦ªã‚¿ã‚¹ã‚¯IDï¼ˆç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã®å ´åˆï¼‰
    
    // çŠ¶æ…‹
    @NSManaged var isCompleted: Bool           // å®Œäº†çŠ¶æ…‹
    @NSManaged var isArchived: Bool           // ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–çŠ¶æ…‹
}
```

#### 3.1.2 Categoryï¼ˆã‚«ãƒ†ã‚´ãƒªï¼‰
```swift
class Category: NSManagedObject {
    @NSManaged var id: UUID
    @NSManaged var name: String               // ã‚«ãƒ†ã‚´ãƒªå
    @NSManaged var color: String              // ã‚«ãƒ†ã‚´ãƒªã®è‰²ï¼ˆHEXã‚³ãƒ¼ãƒ‰ï¼‰
    @NSManaged var createdAt: Date
    @NSManaged var usageCount: Int            // ä½¿ç”¨å›æ•°ï¼ˆã‚ˆãä½¿ã†ã‚«ãƒ†ã‚´ãƒªã®åˆ¤å®šç”¨ï¼‰
    @NSManaged var tasks: NSSet?              // é–¢é€£ã‚¿ã‚¹ã‚¯
}
```

#### 3.1.3 NotificationRecordï¼ˆé€šçŸ¥è¨˜éŒ²ï¼‰
```swift
class NotificationRecord: NSManagedObject {
    @NSManaged var id: UUID
    @NSManaged var taskId: UUID               // é–¢é€£ã‚¿ã‚¹ã‚¯ID
    @NSManaged var notificationId: String     // ãƒ­ãƒ¼ã‚«ãƒ«é€šçŸ¥ID
    @NSManaged var scheduledTime: Date        // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ™‚åˆ»
    @NSManaged var notificationType: NotificationType // ã‚¢ãƒ©ãƒ¼ãƒ /ãƒªãƒã‚¤ãƒ³ãƒ‰
    @NSManaged var isDelivered: Bool          // é…ä¿¡æ¸ˆã¿ã‹ã©ã†ã‹
    @NSManaged var deliveredAt: Date?         // é…ä¿¡æ—¥æ™‚
}
```

#### 3.1.4 PresetTimeï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆæ™‚é–“ï¼‰
```swift
class PresetTime: NSManagedObject {
    @NSManaged var id: UUID
    @NSManaged var name: String               // ãƒ—ãƒªã‚»ãƒƒãƒˆåï¼ˆä¾‹: "ä»Šæ—¥ã®9æ™‚"ï¼‰
    @NSManaged var hour: Int                  // æ™‚
    @NSManaged var minute: Int                // åˆ†
    @NSManaged var offsetDays: Int            // æ—¥ä»˜ã‚ªãƒ•ã‚»ãƒƒãƒˆï¼ˆ0=ä»Šæ—¥ã€1=æ˜æ—¥ãªã©ï¼‰
    @NSManaged var isDefault: Bool            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã©ã†ã‹
    @NSManaged var order: Int                 // è¡¨ç¤ºé †åº
}
```

### 3.2 åˆ—æŒ™å‹å®šç¾©

#### 3.2.1 TaskType
```swift
enum TaskType: String, Codable {
    case task = "task"           // ã‚¿ã‚¹ã‚¯ï¼ˆæœŸé™è¨­å®šï¼‰
    case schedule = "schedule"   // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆé–‹å§‹æ—¥æ™‚è¨­å®šï¼‰
}
```

#### 3.2.2 Priority
```swift
enum Priority: String, Codable {
    case low = "low"     // ä½
    case medium = "medium" // ä¸­
    case high = "high"   // é«˜
}
```

#### 3.2.3 RepeatPattern
```swift
// ç¹°ã‚Šè¿”ã—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚¿ã‚¤ãƒ—
enum RepeatType: String, Codable {
    case daily = "daily"                     // æ¯æ—¥
    case weekly = "weekly"                   // æ¯é€±
    case monthly = "monthly"                 // æ¯æœˆ
    case yearly = "yearly"                   // æ¯å¹´
    case everyNDays = "everyNDays"           // Næ—¥ã”ã¨
    case nthWeekdayOfMonth = "nthWeekdayOfMonth" // æ¯æœˆç¬¬Næ›œæ—¥
    case custom = "custom"                   // ã‚«ã‚¹ã‚¿ãƒ 
}

// ç¹°ã‚Šè¿”ã—ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å«ã‚€ï¼‰
struct RepeatPattern: Codable {
    let type: RepeatType                     // ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¿ã‚¤ãƒ—
    let interval: Int?                       // Næ—¥ã”ã¨ ã® Nï¼ˆeveryNDaysã®å ´åˆï¼‰
    let weekday: Int?                        // æ›œæ—¥ï¼ˆ1=æ—¥æ›œæ—¥ã€œ7=åœŸæ›œæ—¥ã€nthWeekdayOfMonthã®å ´åˆï¼‰
    let week: Int?                           // ç¬¬Né€±ï¼ˆ1=ç¬¬1é€±ã€nthWeekdayOfMonthã®å ´åˆï¼‰
    let customDays: [Int]?                   // ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ›œæ—¥ï¼ˆcustomã®å ´åˆï¼‰

    // ä¾¿åˆ©ãªã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶
    static func daily() -> RepeatPattern {
        return RepeatPattern(type: .daily, interval: nil, weekday: nil, week: nil, customDays: nil)
    }

    static func weekly() -> RepeatPattern {
        return RepeatPattern(type: .weekly, interval: nil, weekday: nil, week: nil, customDays: nil)
    }

    static func monthly() -> RepeatPattern {
        return RepeatPattern(type: .monthly, interval: nil, weekday: nil, week: nil, customDays: nil)
    }

    static func yearly() -> RepeatPattern {
        return RepeatPattern(type: .yearly, interval: nil, weekday: nil, week: nil, customDays: nil)
    }

    static func everyNDays(_ n: Int) -> RepeatPattern {
        return RepeatPattern(type: .everyNDays, interval: n, weekday: nil, week: nil, customDays: nil)
    }

    static func nthWeekdayOfMonth(weekday: Int, week: Int) -> RepeatPattern {
        return RepeatPattern(type: .nthWeekdayOfMonth, interval: nil, weekday: weekday, week: week, customDays: nil)
    }

    static func custom(days: [Int]) -> RepeatPattern {
        return RepeatPattern(type: .custom, interval: nil, weekday: nil, week: nil, customDays: days)
    }
}
```

#### 3.2.4 NotificationType
```swift
enum NotificationType: String, Codable {
    case alarm = "alarm"         // ã‚¢ãƒ©ãƒ¼ãƒ 
    case reminder = "reminder"    // ãƒªãƒã‚¤ãƒ³ãƒ‰
}
```

### 3.3 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

#### 3.3.1 Core Data ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```
Task
â”œâ”€â”€ category (Category) [Optional, To-One]
â”œâ”€â”€ repeatPattern (RepeatPattern) [Optional, Transformable]
â””â”€â”€ notifications (NotificationRecord) [To-Many]

Category
â””â”€â”€ tasks (Task) [To-Many]

NotificationRecord
â””â”€â”€ task (Task) [To-One]
```

**RepeatPatternã®ä¿å­˜æ–¹æ³•:**
- Core Dataã§ã¯`Transformable`å±æ€§ã¨ã—ã¦ä¿å­˜
- `RepeatPattern`ã¯`Codable`ã«æº–æ‹ ã—ãŸstructã®ãŸã‚ã€`NSSecureUnarchiveFromDataTransformer`ã‚’ä½¿ç”¨ã—ã¦ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
- Core Dataãƒ¢ãƒ‡ãƒ«ã‚¨ãƒ‡ã‚£ã‚¿ã§ã®è¨­å®š:
  - å±æ€§å: `repeatPattern`
  - å‹: `Transformable`
  - Custom Class: `RepeatPattern`
  - Transformer: `NSSecureUnarchiveFromDataTransformer`
  - Optional: `true`
- å®Ÿè£…ä¾‹:
  ```swift
  // Task+CoreDataProperties.swift
  @NSManaged var repeatPattern: RepeatPattern?

  // RepeatPattern ã¯ Codable ã«æº–æ‹ ã—ã¦ã„ã‚‹ãŸã‚ã€
  // NSSecureUnarchiveFromDataTransformer ãŒè‡ªå‹•çš„ã«
  // ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãƒ»ãƒ‡ã‚³ãƒ¼ãƒ‰å‡¦ç†ã‚’è¡Œã†
  ```
- ãƒ¡ãƒªãƒƒãƒˆ:
  - ã‚·ãƒ³ãƒ—ãƒ«ã§å®Ÿè£…ãŒå®¹æ˜“
  - RepeatPatternã®æ§‹é€ ã‚’å¤‰æ›´ã—ã¦ã‚‚Core Dataã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´ãŒä¸è¦
  - å€‹åˆ¥ã®å±æ€§ã«åˆ†è§£ã™ã‚‹æ–¹æ³•ã‚ˆã‚Šã‚‚ã‚³ãƒ¼ãƒ‰é‡ãŒå°‘ãªã„

---

## 4. ç”»é¢è¨­è¨ˆ

### 4.1 ç”»é¢ä¸€è¦§

| ç”»é¢ID | ç”»é¢å | èª¬æ˜ |
|--------|--------|------|
| S001 | ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢ | ç™»éŒ²ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’ä¸€è¦§è¡¨ç¤º |
| S002 | ã‚¿ã‚¹ã‚¯ç™»éŒ²ç”»é¢ | æ–°è¦ã‚¿ã‚¹ã‚¯ã‚’ç™»éŒ² |
| S003 | ã‚¿ã‚¹ã‚¯ç·¨é›†ç”»é¢ | æ—¢å­˜ã‚¿ã‚¹ã‚¯ã‚’ç·¨é›† |
| S004 | ã‚¿ã‚¹ã‚¯è©³ç´°ç”»é¢ | ã‚¿ã‚¹ã‚¯ã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤º |
| S005 | ç´°åˆ†åŒ–ææ¡ˆç”»é¢ | LLMã«ã‚ˆã‚‹ã‚¿ã‚¹ã‚¯ç´°åˆ†åŒ–ææ¡ˆã‚’è¡¨ç¤º |
| S006 | ã‚«ãƒ†ã‚´ãƒªç®¡ç†ç”»é¢ | ã‚«ãƒ†ã‚´ãƒªã®ä¸€è¦§ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ |
| S007 | è¨­å®šç”»é¢ | ã‚¢ãƒ—ãƒªè¨­å®š |

### 4.2 ç”»é¢è©³ç´°è¨­è¨ˆ

#### 4.2.1 S001: ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢

**ç”»é¢æ§‹æˆ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ãƒ•ã‚£ãƒ«ã‚¿] [ã‚½ãƒ¼ãƒˆ] [æ¤œç´¢]         â”‚ â† ãƒ˜ãƒƒãƒ€ãƒ¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“‹ ã‚¿ã‚¹ã‚¯å                  â”‚   â”‚
â”‚  â”‚ ğŸ·ï¸ ã‚«ãƒ†ã‚´ãƒª  â­ é‡è¦åº¦      â”‚   â”‚
â”‚  â”‚ ğŸ“… æœŸé™: 2025/01/15 15:00   â”‚   â”‚
â”‚  â”‚ ğŸ”” ãƒªãƒã‚¤ãƒ³ãƒ‰: 1æ™‚é–“é–“éš”     â”‚   â”‚
â”‚  â”‚ [ã‚¹ãƒ¯ã‚¤ãƒ—: å®Œäº†/å‰Šé™¤]        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“‹ åˆ¥ã®ã‚¿ã‚¹ã‚¯                â”‚   â”‚
â”‚  â”‚ ...                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        [+ æ–°è¦ã‚¿ã‚¹ã‚¯è¿½åŠ ]           â”‚ â† å›ºå®šãƒœã‚¿ãƒ³
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Viewæ§‹é€ **
```swift
struct TaskListView: View {
    @StateObject private var viewModel: TaskListViewModel
    @State private var filterMode: FilterMode = .all
    @State private var sortMode: SortMode = .createdAtDesc
    
    var body: some View {
        NavigationView {
            VStack {
                // ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆãƒãƒ¼
                FilterSortBar(...)
                
                // ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ
                List {
                    ForEach(viewModel.tasks) { task in
                        TaskCardView(task: task)
                            .swipeActions(edge: .trailing) {
                                // å®Œäº†ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
                                Button {
                                    viewModel.completeTask(task)
                                } label: {
                                    Label("å®Œäº†", systemImage: "checkmark")
                                }
                                .tint(.green)
                                
                                // å‰Šé™¤ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
                                Button(role: .destructive) {
                                    viewModel.deleteTask(task)
                                } label: {
                                    Label("å‰Šé™¤", systemImage: "trash")
                                }
                            }
                    }
                }
                
                // æ–°è¦ã‚¿ã‚¹ã‚¯è¿½åŠ ãƒœã‚¿ãƒ³
                Button {
                    viewModel.showAddTask = true
                } label: {
                    Label("æ–°è¦ã‚¿ã‚¹ã‚¯è¿½åŠ ", systemImage: "plus.circle.fill")
                        .font(.title2)
                }
                .padding()
            }
            .navigationTitle("ã‚¿ã‚¹ã‚¯ä¸€è¦§")
            .sheet(isPresented: $viewModel.showAddTask) {
                TaskEditView(mode: .create)
            }
        }
    }
}
```

**ViewModel**
```swift
class TaskListViewModel: ObservableObject {
    @Published var tasks: [Task] = []
    @Published var filterMode: FilterMode = .all
    @Published var sortMode: SortMode = .createdAtDesc
    @Published var showAddTask = false
    
    private let taskManager: TaskManager
    
    func loadTasks() {
        tasks = taskManager.fetchTasks(
            filter: filterMode,
            sort: sortMode
        )
    }
    
    func completeTask(_ task: Task) {
        // ãƒªãƒã‚¤ãƒ³ãƒ‰ä¸­ã®ã‚¿ã‚¹ã‚¯ã®å ´åˆã¯ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
        if task.reminderEnabled {
            // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
        } else {
            taskManager.completeTask(task)
        }
    }
    
    func deleteTask(_ task: Task) {
        taskManager.deleteTask(task)
        loadTasks()
    }
}
```

#### 4.2.2 S002/S003: ã‚¿ã‚¹ã‚¯ç™»éŒ²ãƒ»ç·¨é›†ç”»é¢

**ç”»é¢æ§‹æˆ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]  ã‚¿ã‚¹ã‚¯ç™»éŒ²  [ä¿å­˜]   â”‚ â† ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ã‚¿ã‚¹ã‚¯å *                  â”‚   â”‚
â”‚  â”‚ [________________________]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ã‚«ãƒ†ã‚´ãƒª                    â”‚   â”‚
â”‚  â”‚ [ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆå…¥åŠ›]    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é‡è¦åº¦                      â”‚   â”‚
â”‚  â”‚ [ä½] [ä¸­] [é«˜]              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â–¼ æ—¥æ™‚è¨­å®š                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [æœŸé™] [é–‹å§‹æ—¥æ™‚]            â”‚   â”‚
â”‚  â”‚ [æœŸé™ã‚’è¨­å®šã™ã‚‹] [ON/OFF]    â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚ ãƒ—ãƒªã‚»ãƒƒãƒˆæ™‚é–“:              â”‚   â”‚
â”‚  â”‚ [ä»Šæ—¥9æ™‚] [ä»Šæ—¥12æ™‚] ...    â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚ æœŸé™: [DatePicker]           â”‚   â”‚
â”‚  â”‚ â€»ONã®å ´åˆã®ã¿è¡¨ç¤º            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â–¼ ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®š                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ON/OFF]                    â”‚   â”‚
â”‚  â”‚ ã‚¢ãƒ©ãƒ¼ãƒ æ™‚åˆ»: [è¨­å®š]        â”‚   â”‚
â”‚  â”‚ â€»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯æœŸé™è¨­å®šã®æ™‚åˆ» â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â–¼ ãƒªãƒã‚¤ãƒ³ãƒ‰è¨­å®š                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ON/OFF]                    â”‚   â”‚
â”‚  â”‚ é–“éš”: [1æ™‚é–“]               â”‚   â”‚
â”‚  â”‚ ã‚¹ãƒŒãƒ¼ã‚ºæœ€å¤§å›æ•°: [5å›]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â–¼ ç¹°ã‚Šè¿”ã—è¨­å®š                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ON/OFF]                    â”‚   â”‚
â”‚  â”‚ ãƒ‘ã‚¿ãƒ¼ãƒ³: [æ¯æ—¥] [æ¯é€±] ... â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Viewæ§‹é€ **
```swift
struct TaskEditView: View {
    enum Mode {
        case create
        case edit(Task)
    }
    
    let mode: Mode
    @StateObject private var viewModel: TaskEditViewModel
    @Environment(\.dismiss) private var dismiss
    
    var body: some View {
        NavigationView {
            Form {
                // ã‚¿ã‚¹ã‚¯å
                Section {
                    TextField("ã‚¿ã‚¹ã‚¯å", text: $viewModel.title)
                        .font(.title3)
                }
                
                // ã‚«ãƒ†ã‚´ãƒª
                Section("ã‚«ãƒ†ã‚´ãƒª") {
                    CategoryPickerView(
                        selectedCategory: $viewModel.category,
                        categories: viewModel.categories
                    )
                }
                
                // é‡è¦åº¦
                Section("é‡è¦åº¦") {
                    Picker("é‡è¦åº¦", selection: $viewModel.priority) {
                        Text("ä½").tag(Priority.low)
                        Text("ä¸­").tag(Priority.medium)
                        Text("é«˜").tag(Priority.high)
                    }
                    .pickerStyle(.segmented)
                }
                
                // æ—¥æ™‚è¨­å®š
                Section {
                    DateSettingView(
                        taskType: $viewModel.taskType,
                        deadline: $viewModel.deadline,
                        startDateTime: $viewModel.startDateTime,
                        presetTimes: viewModel.presetTimes
                    )
                }
                
                // ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®š
                Section {
                    AlarmSettingView(
                        enabled: $viewModel.alarmEnabled,
                        dateTime: $viewModel.alarmDateTime,
                        sound: $viewModel.alarmSound,
                        defaultDateTime: viewModel.taskType == .task ? viewModel.deadline : viewModel.startDateTime
                    )
                }
                
                // ãƒªãƒã‚¤ãƒ³ãƒ‰è¨­å®š
                Section {
                    ReminderSettingView(
                        enabled: $viewModel.reminderEnabled,
                        interval: $viewModel.reminderInterval,
                        priority: viewModel.priority,
                        taskType: viewModel.taskType,
                        snoozeMaxCount: $viewModel.snoozeMaxCount
                    )
                }
                
                // ç¹°ã‚Šè¿”ã—è¨­å®š
                Section {
                    RepeatSettingView(
                        enabled: $viewModel.isRepeating,
                        pattern: $viewModel.repeatPattern,
                        endDate: $viewModel.repeatEndDate
                    )
                }
            }
            .navigationTitle(mode == .create ? "ã‚¿ã‚¹ã‚¯ç™»éŒ²" : "ã‚¿ã‚¹ã‚¯ç·¨é›†")
            .navigationBarTitleDisplayMode(.inline)
            .toolbar {
                ToolbarItem(placement: .cancellationAction) {
                    Button("ã‚­ãƒ£ãƒ³ã‚»ãƒ«") {
                        dismiss()
                    }
                }
                ToolbarItem(placement: .confirmationAction) {
                    Button("ä¿å­˜") {
                        viewModel.save()
                        dismiss()
                    }
                    .disabled(!viewModel.isValid)
                }
            }
        }
    }
}
```

**è‡ªç„¶è¨€èªè§£æã®çµ±åˆ**
```swift
struct TaskNameInputView: View {
    @Binding var title: String
    @Binding var extractedDateTime: Date?
    @Binding var extractedTaskType: TaskType?
    
    @StateObject private var parser = NaturalLanguageParser()
    
    var body: some View {
        TextField("ã‚¿ã‚¹ã‚¯å", text: $title)
            .onChange(of: title) { newValue in
                parseNaturalLanguage(newValue)
            }
    }
    
    private func parseNaturalLanguage(_ text: String) {
        let result = parser.extractDateTime(from: text)
        if let dateTime = result.dateTime {
            extractedDateTime = dateTime
            extractedTaskType = result.taskType
            // æŠ½å‡ºçµæœã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤º
        }
    }
}
```

**DateSettingViewã®å®Ÿè£…**
```swift
struct DateSettingView: View {
    @Binding var taskType: TaskType
    @Binding var deadline: Date?
    @Binding var startDateTime: Date?
    let presetTimes: [PresetTime]
    
    // æœŸé™/é–‹å§‹æ—¥æ™‚ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹
    private var isDateTimeEnabled: Bool {
        if taskType == .task {
            return deadline != nil
        } else {
            return startDateTime != nil
        }
    }
    
    var body: some View {
        Group {
            // ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã®é¸æŠ
            Picker("ç¨®é¡", selection: $taskType) {
                Text("æœŸé™").tag(TaskType.task)
                Text("é–‹å§‹æ—¥æ™‚").tag(TaskType.schedule)
            }
            .pickerStyle(.segmented)
            
            // æœŸé™/é–‹å§‹æ—¥æ™‚ã‚’è¨­å®šã™ã‚‹ã‹ã©ã†ã‹ã®ãƒˆã‚°ãƒ«
            Toggle(
                taskType == .task ? "æœŸé™ã‚’è¨­å®šã™ã‚‹" : "é–‹å§‹æ—¥æ™‚ã‚’è¨­å®šã™ã‚‹",
                isOn: Binding(
                    get: { isDateTimeEnabled },
                    set: { enabled in
                        if enabled {
                            // æœ‰åŠ¹ã«ã™ã‚‹å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®š
                            if taskType == .task {
                                deadline = Date()
                            } else {
                                startDateTime = Date()
                            }
                        } else {
                            // ç„¡åŠ¹ã«ã™ã‚‹å ´åˆã€nilã«è¨­å®š
                            if taskType == .task {
                                deadline = nil
                            } else {
                                startDateTime = nil
                            }
                        }
                    }
                )
            )
            
            // ãƒ—ãƒªã‚»ãƒƒãƒˆæ™‚é–“ã®è¡¨ç¤ºï¼ˆãƒˆã‚°ãƒ«ãŒOFFã§ã‚‚è¡¨ç¤ºï¼‰
            if !presetTimes.isEmpty {
                ScrollView(.horizontal, showsIndicators: false) {
                    HStack(spacing: 12) {
                        ForEach(presetTimes, id: \.objectID) { preset in
                            PresetTimeButton(
                                preset: preset,
                                taskType: taskType,
                                deadline: $deadline,
                                startDateTime: $startDateTime
                            )
                        }
                    }
                    .padding(.horizontal)
                }
            }
            
            // è¨­å®šãŒæœ‰åŠ¹ãªå ´åˆã®ã¿DatePickerã‚’è¡¨ç¤º
            if isDateTimeEnabled {
                if taskType == .task {
                    DatePicker("æœŸé™", selection: Binding(
                        get: { deadline ?? Date() },
                        set: { deadline = $0 }
                    ), displayedComponents: [.date, .hourAndMinute])
                } else {
                    DatePicker("é–‹å§‹æ—¥æ™‚", selection: Binding(
                        get: { startDateTime ?? Date() },
                        set: { startDateTime = $0 }
                    ), displayedComponents: [.date, .hourAndMinute])
                }
            }
        }
        .environment(\.locale, Locale(identifier: "ja_JP"))
    }
}
```

**æ©Ÿèƒ½è©³ç´°**
- **æ—¥æ™‚è¨­å®šã®ä»»æ„é …ç›®ã¨ã—ã¦ã®å®Ÿè£…**:
  - æ—¥æ™‚è¨­å®šã¯ä»»æ„é …ç›®ã§ã‚ã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æœªè¨­å®šï¼ˆnilï¼‰ã®çŠ¶æ…‹
  - ã€ŒæœŸé™ã‚’è¨­å®šã™ã‚‹ã€/ã€Œé–‹å§‹æ—¥æ™‚ã‚’è¨­å®šã™ã‚‹ã€ãƒˆã‚°ãƒ«ã§æœ‰åŠ¹/ç„¡åŠ¹ã‚’åˆ‡ã‚Šæ›¿ãˆå¯èƒ½
  - ãƒˆã‚°ãƒ«ãŒOFFã®å ´åˆ: æœŸé™/é–‹å§‹æ—¥æ™‚ã¯æœªè¨­å®šï¼ˆnilï¼‰ã®ã¾ã¾ã€DatePickerã¯éè¡¨ç¤º
  - ãƒˆã‚°ãƒ«ãŒONã®å ´åˆ: DatePickerãŒè¡¨ç¤ºã•ã‚Œã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ç¾åœ¨æ™‚åˆ»ãŒè¨­å®šã•ã‚Œã‚‹
  - ãƒ—ãƒªã‚»ãƒƒãƒˆæ™‚é–“ãƒœã‚¿ãƒ³ã¯ãƒˆã‚°ãƒ«ãŒOFFã§ã‚‚è¡¨ç¤ºã•ã‚Œã€ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨è‡ªå‹•çš„ã«ãƒˆã‚°ãƒ«ãŒONã«ãªã‚Šå€¤ãŒè¨­å®šã•ã‚Œã‚‹
  - ãƒˆã‚°ãƒ«ã‚’OFFã«ã™ã‚‹ã¨ã€è¨­å®šã•ã‚Œã¦ã„ãŸå€¤ãŒnilã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹
  - ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºçš„ã«è¨­å®šã—ãªã„é™ã‚Šã€æœŸé™/é–‹å§‹æ—¥æ™‚ã¯è¨­å®šã•ã‚Œãªã„

- **ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®šã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤**:
  - ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®šã‚’æœ‰åŠ¹ã«ã—ãŸéš›ã€ã‚¢ãƒ©ãƒ¼ãƒ æ™‚åˆ»ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯æœŸé™è¨­å®šã§è¨­å®šã—ãŸæ™‚åˆ»ã‚’ä½¿ç”¨ã™ã‚‹
  - ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ãŒã€ŒæœŸé™ã€ã®å ´åˆ: `deadline`ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ä½¿ç”¨
  - ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ãŒã€Œé–‹å§‹æ—¥æ™‚ã€ã®å ´åˆ: `startDateTime`ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ä½¿ç”¨
  - æœŸé™è¨­å®šãŒæœªè¨­å®šã®å ´åˆã®ã¿ã€ç¾åœ¨æ™‚åˆ»ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ä½¿ç”¨
  - ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æœŸé™è¨­å®šã®æ™‚åˆ»ã‚’åŸºæº–ã«ã‚¢ãƒ©ãƒ¼ãƒ æ™‚åˆ»ã‚’è¨­å®šã§ãã€æ“ä½œãŒç›´æ„Ÿçš„ã«ãªã‚‹

#### 4.2.3 S006: ã‚«ãƒ†ã‚´ãƒªç®¡ç†ç”»é¢

**ç”»é¢æ§‹æˆ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [é–‰ã˜ã‚‹]  ã‚«ãƒ†ã‚´ãƒªç®¡ç†             â”‚ â† ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸŸ¦ ã‚«ãƒ†ã‚´ãƒªå               â”‚   â”‚
â”‚  â”‚    5å›ä½¿ç”¨  3ä»¶ã®ã‚¿ã‚¹ã‚¯     â”‚   â”‚
â”‚  â”‚    [ç·¨é›†] [ã‚¹ãƒ¯ã‚¤ãƒ—: å‰Šé™¤]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸŸ¥ åˆ¥ã®ã‚«ãƒ†ã‚´ãƒª              â”‚   â”‚
â”‚  â”‚    ...                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Viewæ§‹é€ **
```swift
struct CategoryManagementView: View {
    @StateObject private var viewModel: CategoryManagementViewModel
    @Environment(\.managedObjectContext) private var viewContext
    @Environment(\.dismiss) private var dismiss
    
    var body: some View {
        NavigationView {
            VStack {
                // ãƒ˜ãƒƒãƒ€ãƒ¼
                AppHeaderView(screenTitle: "ã‚«ãƒ†ã‚´ãƒªç®¡ç†")
                
                // ã‚«ãƒ†ã‚´ãƒªãƒªã‚¹ãƒˆ
                if viewModel.categories.isEmpty {
                    // ç©ºçŠ¶æ…‹ã®è¡¨ç¤º
                    VStack {
                        Image(systemName: "folder.badge.questionmark")
                        Text("ã‚«ãƒ†ã‚´ãƒªãŒã‚ã‚Šã¾ã›ã‚“")
                    }
                } else {
                    List {
                        ForEach(viewModel.categories) { category in
                            CategoryManagementRow(
                                category: category,
                                viewModel: viewModel
                            )
                            .swipeActions(edge: .trailing) {
                                Button(role: .destructive) {
                                    viewModel.categoryToDelete = category
                                } label: {
                                    Label("å‰Šé™¤", systemImage: "trash")
                                }
                            }
                        }
                    }
                }
            }
            .navigationBarTitleDisplayMode(.inline)
            .toolbar {
                ToolbarItem(placement: .cancellationAction) {
                    Button("é–‰ã˜ã‚‹") { dismiss() }
                }
            }
            .sheet(item: $viewModel.categoryToEdit) { category in
                CategoryEditView(...)
            }
            .alert("ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ", ...) {
                // å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
            }
        }
    }
}
```

**ViewModel**
```swift
class CategoryManagementViewModel: ObservableObject {
    @Published var categories: [Category] = []
    @Published var categoryToDelete: Category?
    @Published var categoryToEdit: Category?
    @Published var editingName: String = ""
    @Published var editingColor: String = "#007AFF"
    
    private let viewContext: NSManagedObjectContext
    private var categoryManager: CategoryManager {
        CategoryManager(viewContext: viewContext)
    }
    
    func loadCategories() {
        categories = categoryManager.fetchCategories()
    }
    
    func deleteCategory(_ category: Category) {
        try? categoryManager.deleteCategory(category)
        loadCategories()
    }
    
    func startEditing(_ category: Category) {
        categoryToEdit = category
        editingName = category.name ?? ""
        editingColor = category.color ?? "#007AFF"
    }
    
    func saveEditing() {
        guard let category = categoryToEdit else { return }
        if editingName != category.name {
            try? categoryManager.updateCategoryName(category, name: editingName)
        }
        if editingColor != category.color {
            try? categoryManager.updateCategoryColor(category, color: editingColor)
        }
        loadCategories()
        categoryToEdit = nil
    }
}
```

**æ©Ÿèƒ½è©³ç´°**
- **ã‚«ãƒ†ã‚´ãƒªä¸€è¦§è¡¨ç¤º**:
  - ä½¿ç”¨å›æ•°é †ã«ã‚½ãƒ¼ãƒˆã—ã¦è¡¨ç¤º
  - å„ã‚«ãƒ†ã‚´ãƒªã«è‰²ã€åå‰ã€ä½¿ç”¨å›æ•°ã€é–¢é€£ã‚¿ã‚¹ã‚¯æ•°ã‚’è¡¨ç¤º
  - ã‚«ãƒ†ã‚´ãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ç©ºçŠ¶æ…‹ã‚’è¡¨ç¤º
- **ã‚«ãƒ†ã‚´ãƒªç·¨é›†**:
  - ã‚«ãƒ†ã‚´ãƒªè¡Œã®ç·¨é›†ãƒœã‚¿ãƒ³ã‹ã‚‰ç·¨é›†ç”»é¢ã‚’é–‹ã
  - ã‚«ãƒ†ã‚´ãƒªåã®å¤‰æ›´
  - ã‚«ãƒ†ã‚´ãƒªã®è‰²ã®å¤‰æ›´ï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆè‰²ã‹ã‚‰é¸æŠï¼‰
- **ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤**:
  - ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¾ãŸã¯ç·¨é›†ç”»é¢ã‹ã‚‰å‰Šé™¤å¯èƒ½
  - å‰Šé™¤å‰ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
  - é–¢é€£ã‚¿ã‚¹ã‚¯ãŒã‚ã‚‹å ´åˆã¯è­¦å‘Šã‚’è¡¨ç¤º
- **ç”»é¢é·ç§»**:
  - ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
  - ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚·ãƒ¼ãƒˆã§è¡¨ç¤º

#### 4.2.4 S005: ç´°åˆ†åŒ–ææ¡ˆç”»é¢

**ç”»é¢æ§‹æˆ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [é–‰ã˜ã‚‹]  ã‚¿ã‚¹ã‚¯ç´°åˆ†åŒ–             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  å…ƒã®ã‚¿ã‚¹ã‚¯:                        â”‚
â”‚  ã€Œéƒ¨å±‹ã®æƒé™¤ã€                     â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [å‡¦ç†ä¸­...]                 â”‚   â”‚ â† LLMå‡¦ç†ä¸­
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  ææ¡ˆã•ã‚ŒãŸç´°åˆ†åŒ–ã‚¿ã‚¹ã‚¯:             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜‘ åºŠã‚’æƒé™¤æ©Ÿã§ã‹ã‘ã‚‹        â”‚   â”‚
â”‚  â”‚ â˜‘ çª“ã‚’æ‹­ã                  â”‚   â”‚
â”‚  â”‚ â˜‘ ã‚´ãƒŸã‚’æ¨ã¦ã‚‹              â”‚   â”‚
â”‚  â”‚ â˜ æœºã‚’æ•´ç†ã™ã‚‹              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  [æ‰¿èª] [ä¿®æ­£] [å´ä¸‹]               â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Viewæ§‹é€ **
```swift
struct TaskSubdivisionView: View {
    let originalTask: Task
    @StateObject private var viewModel: TaskSubdivisionViewModel
    @Environment(\.dismiss) private var dismiss
    
    var body: some View {
        NavigationView {
            VStack {
                // å…ƒã®ã‚¿ã‚¹ã‚¯è¡¨ç¤º
                Text("å…ƒã®ã‚¿ã‚¹ã‚¯:")
                    .font(.headline)
                Text(originalTask.title)
                    .font(.title2)
                    .padding()
                
                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¾ãŸã¯ææ¡ˆãƒªã‚¹ãƒˆ
                if viewModel.isLoading {
                    ProgressView("å‡¦ç†ä¸­...")
                        .padding()
                } else if let proposals = viewModel.proposals {
                    List {
                        ForEach(proposals) { proposal in
                            HStack {
                                Toggle("", isOn: Binding(
                                    get: { proposal.isSelected },
                                    set: { viewModel.toggleProposal(proposal, isSelected: $0) }
                                ))
                                Text(proposal.title)
                            }
                        }
                    }
                } else if let error = viewModel.error {
                    VStack {
                        Text("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")
                            .foregroundColor(.red)
                        Text(error.localizedDescription)
                        Button("å†è©¦è¡Œ") {
                            viewModel.generateProposals()
                        }
                    }
                }
                
                // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³
                HStack {
                    Button("å´ä¸‹") {
                        dismiss()
                    }
                    .buttonStyle(.bordered)
                    
                    Button("ä¿®æ­£") {
                        viewModel.showEditMode = true
                    }
                    .buttonStyle(.bordered)
                    
                    Button("æ‰¿èª") {
                        viewModel.approveProposals()
                        dismiss()
                    }
                    .buttonStyle(.borderedProminent)
                    .disabled(viewModel.proposals?.isEmpty ?? true)
                }
                .padding()
            }
            .navigationTitle("ã‚¿ã‚¹ã‚¯ç´°åˆ†åŒ–")
            .navigationBarTitleDisplayMode(.inline)
            .toolbar {
                ToolbarItem(placement: .cancellationAction) {
                    Button("é–‰ã˜ã‚‹") {
                        dismiss()
                    }
                }
            }
            .onAppear {
                viewModel.generateProposals(for: originalTask)
            }
        }
    }
}
```

---

## 5. ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯è¨­è¨ˆ

### 5.1 ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯

#### 5.1.1 TaskManager

```swift
class TaskManager {
    private let repository: TaskRepository
    private let notificationManager: NotificationManager
    
    // ã‚¿ã‚¹ã‚¯ä½œæˆ
    func createTask(_ task: Task) async throws {
        // 1. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        try validateTask(task)
        
        // 2. ä¿å­˜
        try await repository.save(task)
        
        // 3. é€šçŸ¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        if task.alarmEnabled {
            try await notificationManager.scheduleAlarm(for: task)
        }
        if task.reminderEnabled {
            try await notificationManager.scheduleReminder(for: task)
        }
        
        // 4. ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã®å ´åˆã¯æ¬¡å›ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
        if task.isRepeating {
            try await generateNextRepeatInstance(for: task)
        }
    }
    
    // ã‚¿ã‚¹ã‚¯å®Œäº†
    func completeTask(_ task: Task) async throws {
        // 1. å®Œäº†ç¢ºèªï¼ˆãƒªãƒã‚¤ãƒ³ãƒ‰ä¸­ã®å ´åˆã¯ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒå¿…è¦ï¼‰
        if task.reminderEnabled && !task.isCompleted {
            // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã¯UIå±¤ã§å‡¦ç†
        }
        
        // 2. ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†çŠ¶æ…‹ã«æ›´æ–°
        task.isCompleted = true
        task.completedAt = Date()
        
        // 3. é€šçŸ¥ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        try await notificationManager.cancelNotifications(for: task)
        
        // 4. ä¿å­˜
        try await repository.save(task)
        
        // 5. ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã®å ´åˆã¯æ¬¡å›ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
        if task.isRepeating {
            try await generateNextRepeatInstance(for: task)
        }
    }
    
    // ã‚¿ã‚¹ã‚¯å‰Šé™¤
    func deleteTask(_ task: Task) async throws {
        // 1. é€šçŸ¥ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        try await notificationManager.cancelNotifications(for: task)
        
        // 2. å‰Šé™¤
        try await repository.delete(task)
    }
    
    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    private func validateTask(_ task: Task) throws {
        guard !task.title.isEmpty else {
            throw TaskError.invalidTitle
        }
        
        // æ—¥æ™‚è¨­å®šã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        if let deadline = task.deadline, let startDateTime = task.startDateTime {
            guard deadline >= startDateTime else {
                throw TaskError.invalidDateTime
            }
        }
    }
}
```

### 5.2 ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯

#### 5.2.1 ReminderService

```swift
class ReminderService {
    private let notificationManager: NotificationManager
    
    // ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆiOSé€šçŸ¥64å€‹åˆ¶é™ã«å¯¾å¿œï¼‰
    func scheduleReminder(for task: Task) async throws {
        guard task.reminderEnabled else { return }

        let intervals = calculateReminderIntervals(for: task)
        let startTime = task.reminderStartTime ?? Date()
        let endTime = task.reminderEndTime ?? task.deadline ?? task.startDateTime

        // iOS ã®é€šçŸ¥64å€‹åˆ¶é™ã«å¯¾å¿œã™ã‚‹ãŸã‚ã€ç›´è¿‘ã®é€šçŸ¥ã®ã¿ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        // é‡è¦åº¦ã«å¿œã˜ã¦æœ€å¤§é€šçŸ¥æ•°ã‚’èª¿æ•´
        let maxNotificationsPerTask: Int
        switch task.priority {
        case .high:
            maxNotificationsPerTask = 15  // é«˜é‡è¦åº¦: æœ€å¤§15å€‹
        case .medium:
            maxNotificationsPerTask = 10  // ä¸­é‡è¦åº¦: æœ€å¤§10å€‹
        case .low:
            maxNotificationsPerTask = 5   // ä½é‡è¦åº¦: æœ€å¤§5å€‹
        }

        var currentTime = startTime
        var notificationCount = 0

        // ç›´è¿‘ã®é€šçŸ¥ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        while notificationCount < maxNotificationsPerTask {
            // ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ã¦ã„ãªã„å ´åˆã®ã¿é€šçŸ¥ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
            if !task.isCompleted {
                let interval = intervals[notificationCount % intervals.count]
                currentTime = currentTime.addingTimeInterval(TimeInterval(interval * 60))

                if let endTime = endTime, currentTime > endTime {
                    break
                }

                try await notificationManager.scheduleReminderNotification(
                    for: task,
                    at: currentTime
                )
            }

            notificationCount += 1
        }

        // æ³¨: ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã‚„ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯ã§ã€æ¬¡ã®é€šçŸ¥ã‚’è¿½åŠ ã§ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã™ã‚‹
        // å®Ÿè£…ã¯ NotificationRefreshService ã§è¡Œã†ï¼ˆå¾Œè¿°ï¼‰
    }
    
    // ãƒªãƒã‚¤ãƒ³ãƒ‰é–“éš”ã®è¨ˆç®—ï¼ˆé‡è¦åº¦ã¨ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã«åŸºã¥ãï¼‰
    private func calculateReminderIntervals(for task: Task) -> [Int] {
        let priority = task.priority
        let taskType = task.taskType
        
        switch (priority, taskType) {
        case (.low, .task):
            // ä½é‡è¦åº¦ãƒ»ã‚¿ã‚¹ã‚¯: 24æ™‚é–“é–“éš”
            return [1440] // 24æ™‚é–“ = 1440åˆ†
            
        case (.medium, .task):
            // ä¸­é‡è¦åº¦ãƒ»ã‚¿ã‚¹ã‚¯: 3æ™‚é–“é–“éš”
            return [180] // 3æ™‚é–“ = 180åˆ†
            
        case (.high, .task):
            // é«˜é‡è¦åº¦ãƒ»ã‚¿ã‚¹ã‚¯: 1æ™‚é–“é–“éš”
            return [60] // 1æ™‚é–“ = 60åˆ†
            
        case (.low, .schedule):
            // ä½é‡è¦åº¦ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ®µéšçš„ãƒªãƒã‚¤ãƒ³ãƒ‰
            return calculateStagedIntervals(
                startDateTime: task.startDateTime!,
                stages: [
                    (days: 3, interval: 1440),    // 3æ—¥å‰ã‹ã‚‰: 1æ—¥1å›
                    (days: 1, interval: 720),      // 1æ—¥å‰ã‹ã‚‰: 12æ™‚é–“é–“éš”
                    (hours: 6, interval: 360),      // 6æ™‚é–“å‰ã‹ã‚‰: 6æ™‚é–“é–“éš”
                    (hours: 1, interval: 60),      // 1æ™‚é–“å‰ã‹ã‚‰: 1æ™‚é–“é–“éš”
                ],
                overdueInterval: 30                 // é–‹å§‹æ—¥æ™‚è¶…éå¾Œ: 30åˆ†é–“éš”
            )
            
        case (.medium, .schedule):
            // ä¸­é‡è¦åº¦ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ®µéšçš„ãƒªãƒã‚¤ãƒ³ãƒ‰
            return calculateStagedIntervals(
                startDateTime: task.startDateTime!,
                stages: [
                    (days: 7, interval: 1440),     // 1é€±é–“å‰ã‹ã‚‰: 1æ—¥1å›
                    (days: 3, interval: 720),       // 3æ—¥å‰ã‹ã‚‰: 12æ™‚é–“é–“éš”
                    (days: 1, interval: 360),       // 1æ—¥å‰ã‹ã‚‰: 6æ™‚é–“é–“éš”
                    (hours: 6, interval: 180),      // 6æ™‚é–“å‰ã‹ã‚‰: 3æ™‚é–“é–“éš”
                    (hours: 3, interval: 60),       // 3æ™‚é–“å‰ã‹ã‚‰: 1æ™‚é–“é–“éš”
                    (hours: 1, interval: 30),       // 1æ™‚é–“å‰ã‹ã‚‰: 30åˆ†é–“éš”
                ],
                overdueInterval: 15                 // é–‹å§‹æ—¥æ™‚è¶…éå¾Œ: 15åˆ†é–“éš”
            )
            
        case (.high, .schedule):
            // é«˜é‡è¦åº¦ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ®µéšçš„ãƒªãƒã‚¤ãƒ³ãƒ‰
            return calculateStagedIntervals(
                startDateTime: task.startDateTime!,
                stages: [
                    (days: 7, interval: 1440),     // 1é€±é–“å‰ã‹ã‚‰: 1æ—¥1å›
                    (days: 3, interval: 720),       // 3æ—¥å‰ã‹ã‚‰: 12æ™‚é–“é–“éš”
                    (days: 1, interval: 360),       // 1æ—¥å‰ã‹ã‚‰: 6æ™‚é–“é–“éš”
                    (hours: 6, interval: 180),      // 6æ™‚é–“å‰ã‹ã‚‰: 3æ™‚é–“é–“éš”
                    (hours: 3, interval: 60),       // 3æ™‚é–“å‰ã‹ã‚‰: 1æ™‚é–“é–“éš”
                    (hours: 1, interval: 30),       // 1æ™‚é–“å‰ã‹ã‚‰: 30åˆ†é–“éš”
                    (hours: 0.5, interval: 15),     // 30åˆ†å‰ã‹ã‚‰: 15åˆ†é–“éš”
                    (hours: 0.25, interval: 5),    // 15åˆ†å‰ã‹ã‚‰: 5åˆ†é–“éš”
                    (hours: 0.083, interval: 1),    // 5åˆ†å‰ã‹ã‚‰: 1åˆ†é–“éš”
                ],
                overdueInterval: 1                  // é–‹å§‹æ—¥æ™‚è¶…éå¾Œ: 1åˆ†é–“éš”
            )
        }
    }
    
    // æ®µéšçš„ãƒªãƒã‚¤ãƒ³ãƒ‰é–“éš”ã®è¨ˆç®—
    private func calculateStagedIntervals(
        startDateTime: Date,
        stages: [(days: Double?, hours: Double?, interval: Int)],
        overdueInterval: Int
    ) -> [Int] {
        let now = Date()
        let timeUntilStart = startDateTime.timeIntervalSince(now)
        
        var intervals: [Int] = []
        
        // å„ã‚¹ãƒ†ãƒ¼ã‚¸ã®é–“éš”ã‚’è¨ˆç®—
        for stage in stages {
            let threshold: TimeInterval
            if let days = stage.days {
                threshold = days * 86400
            } else if let hours = stage.hours {
                threshold = hours * 3600
            } else {
                continue
            }
            
            if timeUntilStart > threshold {
                intervals.append(stage.interval)
            }
        }
        
        // é–‹å§‹æ—¥æ™‚ã‚’éããŸå ´åˆã®é–“éš”
        if timeUntilStart <= 0 {
            intervals.append(overdueInterval)
        }
        
        return intervals.isEmpty ? [60] : intervals
    }
}
```

### 5.3 é€šçŸ¥ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯

#### 5.3.1 NotificationManager

```swift
class NotificationManager {
    private let center = UNUserNotificationCenter.current()
    
    // é€šçŸ¥æ¨©é™ã®è¦æ±‚
    func requestAuthorization() async throws {
        let granted = try await center.requestAuthorization(options: [
            .alert, .sound, .badge, .provisional
        ])

        guard granted else {
            throw NotificationError.authorizationDenied
        }

        // iOS 15+ ã§ Time Sensitive é€šçŸ¥ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®æº–å‚™
        // Info.plist ã« NSUserNotificationsUsageDescription ã®è¿½åŠ ãŒå¿…è¦
        // ã€Œé‡è¦ãªã‚¿ã‚¹ã‚¯ã®é€šçŸ¥ã‚’æ™‚é–“ã«æ•æ„Ÿãªé€šçŸ¥ã¨ã—ã¦é€ä¿¡ã—ã¾ã™ã€
    }
    
    // ã‚¢ãƒ©ãƒ¼ãƒ é€šçŸ¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
    func scheduleAlarm(for task: Task) async throws {
        guard let alarmDateTime = task.alarmDateTime else { return }
        guard alarmDateTime > Date() else { return }
        
        let content = UNMutableNotificationContent()
        content.title = "ã‚¢ãƒ©ãƒ¼ãƒ : \(task.title)"
        content.body = "è¨­å®šæ™‚åˆ»ã«ãªã‚Šã¾ã—ãŸ"
        content.sound = UNNotificationSound(named: UNNotificationSoundName(task.alarmSound ?? "default"))
        content.categoryIdentifier = "ALARM"
        
        // é‡è¦åº¦è¨­å®š
        content.interruptionLevel = mapPriorityToInterruptionLevel(task.priority)
        
        // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        let trigger = UNCalendarNotificationTrigger(
            dateMatching: Calendar.current.dateComponents(
                [.year, .month, .day, .hour, .minute],
                from: alarmDateTime
            ),
            repeats: false
        )
        
        let request = UNNotificationRequest(
            identifier: "alarm_\(task.id.uuidString)",
            content: content,
            trigger: trigger
        )
        
        try await center.add(request)
    }
    
    // ãƒªãƒã‚¤ãƒ³ãƒ‰é€šçŸ¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
    func scheduleReminderNotification(for task: Task, at date: Date) async throws {
        guard date > Date() else { return }
        
        let content = UNMutableNotificationContent()
        content.title = "ãƒªãƒã‚¤ãƒ³ãƒ‰: \(task.title)"
        if let category = task.category {
            content.body = "ã‚«ãƒ†ã‚´ãƒª: \(category.name)"
        } else {
            content.body = "ã‚¿ã‚¹ã‚¯ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
        }
        content.sound = .default
        content.categoryIdentifier = "REMINDER"
        
        // é‡è¦åº¦è¨­å®š
        content.interruptionLevel = mapPriorityToInterruptionLevel(task.priority)
        
        // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        let trigger = UNCalendarNotificationTrigger(
            dateMatching: Calendar.current.dateComponents(
                [.year, .month, .day, .hour, .minute],
                from: date
            ),
            repeats: false
        )
        
        let request = UNNotificationRequest(
            identifier: "reminder_\(task.id.uuidString)_\(date.timeIntervalSince1970)",
            content: content,
            trigger: trigger
        )
        
        try await center.add(request)
    }
    
    // é€šçŸ¥ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    func cancelNotifications(for task: Task) async {
        let identifiers = [
            "alarm_\(task.id.uuidString)",
            // ãƒªãƒã‚¤ãƒ³ãƒ‰é€šçŸ¥ã®IDã¯å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã§å‰Šé™¤
        ]
        
        // ãƒªãƒã‚¤ãƒ³ãƒ‰é€šçŸ¥ã‚’å‰Šé™¤ã™ã‚‹ãŸã‚ã€å…¨ã¦ã®é€šçŸ¥ã‚’å–å¾—ã—ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        let pendingRequests = await center.pendingNotificationRequests()
        let taskNotificationIds = pendingRequests
            .filter { $0.identifier.contains(task.id.uuidString) }
            .map { $0.identifier }
        
        center.removePendingNotificationRequests(withIdentifiers: taskNotificationIds)
    }
    
    // ã‚¹ãƒŒãƒ¼ã‚ºå‡¦ç†
    func snoozeReminder(for task: Task) async throws {
        // ã‚¹ãƒŒãƒ¼ã‚ºå›æ•°ã‚’ãƒã‚§ãƒƒã‚¯
        guard task.snoozeCount < task.snoozeMaxCount || task.snoozeUnlimited else {
            throw NotificationError.maxSnoozeReached
        }
        
        // ã‚¹ãƒŒãƒ¼ã‚ºå›æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
        task.snoozeCount += 1
        
        // æ¬¡ã®ãƒªãƒã‚¤ãƒ³ãƒ‰æ™‚åˆ»ã‚’è¨ˆç®—ï¼ˆç¾åœ¨æ™‚åˆ» + ãƒªãƒã‚¤ãƒ³ãƒ‰é–“éš”ï¼‰
        let nextReminderTime = Date().addingTimeInterval(
            TimeInterval(task.reminderInterval * 60)
        )
        
        // æ¬¡ã®ãƒªãƒã‚¤ãƒ³ãƒ‰é€šçŸ¥ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
        try await scheduleReminderNotification(for: task, at: nextReminderTime)
    }
    
    // é‡è¦åº¦ã‚’é€šçŸ¥é‡è¦åº¦ã«ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆiOS 15+ï¼‰
    private func mapPriorityToInterruptionLevel(_ priority: Priority) -> UNNotificationInterruptionLevel {
        switch priority {
        case .high:
            return .timeSensitive  // æ™‚é–“ã«æ•æ„Ÿãªé€šçŸ¥ï¼ˆFocus Modeã§ã‚‚è¡¨ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã„ï¼‰
        case .medium:
            return .active  // é€šå¸¸ã®é€šçŸ¥
        case .low:
            return .passive  // æ§ãˆã‚ãªé€šçŸ¥
        }
    }

    // æ³¨: .critical ã¯å¥åº·ãƒ»å®‰å…¨é–¢é€£ã‚¢ãƒ—ãƒªã®ã¿ãŒä½¿ç”¨å¯èƒ½ãªç‰¹åˆ¥ãªæ¨©é™ã§ã‚ã‚Šã€
    // ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¢ãƒ—ãƒªã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚
    // .timeSensitive ã§ååˆ†ãªåŠ¹æœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚
}
```

### 5.4 ã‚¿ã‚¹ã‚¯ç´°åˆ†åŒ–ãƒ­ã‚¸ãƒƒã‚¯

#### 5.4.1 TaskSubdivisionService

```swift
class TaskSubdivisionService {
    private let apiClient: LLMAPIClient
    private let taskManager: TaskManager

    // UserDefaults ã‚­ãƒ¼
    private let lastSubdivisionDateKey = "lastSubdivisionDate"
    private let subdivisionCountKey = "subdivisionCount"

    // ç´°åˆ†åŒ–ææ¡ˆã®ç”Ÿæˆ
    func generateSubdivisionProposals(for task: Task) async throws -> [SubdivisionProposal] {
        // 1. ä½¿ç”¨é‡åˆ¶é™ã‚’ãƒã‚§ãƒƒã‚¯
        guard canSubdivide() else {
            throw APIError.rateLimitExceeded
        }

        // 2. LLM APIã‚’å‘¼ã³å‡ºã—ã¦ã‚¿ã‚¹ã‚¯ã‚’ç´°åˆ†åŒ–
        let response = try await apiClient.subdivideTask(task.title)

        // 3. ä½¿ç”¨å›æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
        incrementSubdivisionCount()

        // 4. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ‘ãƒ¼ã‚¹
        let proposals = response.subtasks.map { subtaskTitle in
            SubdivisionProposal(
                title: subtaskTitle,
                isSelected: true
            )
        }

        return proposals
    }

    // ææ¡ˆã‚’æ‰¿èªã—ã¦ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ
    func approveProposals(_ proposals: [SubdivisionProposal], parentTask: Task) async throws {
        for proposal in proposals where proposal.isSelected {
            let subtask = Task(
                title: proposal.title,
                category: parentTask.category,
                priority: parentTask.priority,
                taskType: parentTask.taskType,
                deadline: parentTask.deadline,
                startDateTime: parentTask.startDateTime,
                reminderEnabled: parentTask.reminderEnabled,
                reminderInterval: parentTask.reminderInterval
            )

            try await taskManager.createTask(subtask)
        }
    }

    // ç´°åˆ†åŒ–å¯èƒ½ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆ1æ—¥5å›åˆ¶é™ï¼‰
    private func canSubdivide() -> Bool {
        let calendar = Calendar.current
        let today = calendar.startOfDay(for: Date())

        // UserDefaultsã‹ã‚‰å‰å›ã®ä½¿ç”¨æ—¥ã¨ä½¿ç”¨å›æ•°ã‚’å–å¾—
        let lastDateString = UserDefaults.standard.string(forKey: lastSubdivisionDateKey)
        let count = UserDefaults.standard.integer(forKey: subdivisionCountKey)

        // æ—¥ä»˜ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if let lastDateString = lastDateString,
           let lastDate = ISO8601DateFormatter().date(from: lastDateString) {
            let lastDay = calendar.startOfDay(for: lastDate)

            if today > lastDay {
                // æ—¥ä»˜ãŒå¤‰ã‚ã£ãŸã®ã§ãƒªã‚»ãƒƒãƒˆ
                resetSubdivisionCount()
                return true
            }
        } else {
            // åˆå›åˆ©ç”¨ã®å ´åˆ
            resetSubdivisionCount()
            return true
        }

        // 5å›æœªæº€ãªã‚‰åˆ©ç”¨å¯èƒ½
        return count < 5
    }

    // ä½¿ç”¨å›æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
    private func incrementSubdivisionCount() {
        let calendar = Calendar.current
        let today = calendar.startOfDay(for: Date())
        let todayString = ISO8601DateFormatter().string(from: today)

        let count = UserDefaults.standard.integer(forKey: subdivisionCountKey)
        UserDefaults.standard.set(todayString, forKey: lastSubdivisionDateKey)
        UserDefaults.standard.set(count + 1, forKey: subdivisionCountKey)
    }

    // ä½¿ç”¨å›æ•°ã‚’ãƒªã‚»ãƒƒãƒˆ
    private func resetSubdivisionCount() {
        let calendar = Calendar.current
        let today = calendar.startOfDay(for: Date())
        let todayString = ISO8601DateFormatter().string(from: today)

        UserDefaults.standard.set(todayString, forKey: lastSubdivisionDateKey)
        UserDefaults.standard.set(0, forKey: subdivisionCountKey)
    }

    // æ®‹ã‚Šä½¿ç”¨å¯èƒ½å›æ•°ã‚’å–å¾—ï¼ˆUIè¡¨ç¤ºç”¨ï¼‰
    func getRemainingSubdivisionCount() -> Int {
        guard canSubdivide() else { return 0 }

        let count = UserDefaults.standard.integer(forKey: subdivisionCountKey)
        return max(0, 5 - count)
    }
}
```

#### 5.4.2 LLMAPIClient

```swift
class LLMAPIClient {
    private let apiKey: String
    private let baseURL: URL
    private let session: URLSession
    
    struct SubdivisionResponse: Codable {
        let subtasks: [String]
    }
    
    // ã‚¿ã‚¹ã‚¯ç´°åˆ†åŒ–APIå‘¼ã³å‡ºã—
    func subdivideTask(_ taskTitle: String) async throws -> SubdivisionResponse {
        // APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆä¾‹: OpenAI APIï¼‰
        let url = baseURL.appendingPathComponent("/v1/chat/completions")
        
        var request = URLRequest(url: url)
        request.httpMethod = "POST"
        request.setValue("Bearer \(apiKey)", forHTTPHeaderField: "Authorization")
        request.setValue("application/json", forHTTPHeaderField: "Content-Type")
        
        // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹ç¯‰
        let prompt = """
        ä»¥ä¸‹ã®ã‚¿ã‚¹ã‚¯ã‚’3-5å€‹ã®å°ã•ãªã‚¿ã‚¹ã‚¯ã«ç´°åˆ†åŒ–ã—ã¦ãã ã•ã„ã€‚
        å„ã‚¿ã‚¹ã‚¯ã¯å…·ä½“çš„ã§å®Ÿè¡Œå¯èƒ½ãªã‚‚ã®ã«ã—ã¦ãã ã•ã„ã€‚
        
        ã‚¿ã‚¹ã‚¯: \(taskTitle)
        
        å‡ºåŠ›å½¢å¼: JSONé…åˆ—ï¼ˆå„è¦ç´ ã¯ã‚¿ã‚¹ã‚¯åã®æ–‡å­—åˆ—ï¼‰
        """
        
        let body: [String: Any] = [
            "model": "gpt-3.5-turbo",
            "messages": [
                ["role": "user", "content": prompt]
            ],
            "temperature": 0.7,
            "max_tokens": 500
        ]
        
        request.httpBody = try JSONSerialization.data(withJSONObject: body)
        
        // ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ10ç§’ï¼‰
        let (data, response) = try await session.data(for: request)
        
        guard let httpResponse = response as? HTTPURLResponse,
              httpResponse.statusCode == 200 else {
            throw APIError.invalidResponse
        }
        
        // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ‘ãƒ¼ã‚¹
        let decoder = JSONDecoder()
        let apiResponse = try decoder.decode(OpenAIResponse.self, from: data)
        
        // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’æŠ½å‡º
        guard let content = apiResponse.choices.first?.message.content else {
            throw APIError.invalidResponse
        }
        
        // JSONé…åˆ—ã‚’ãƒ‘ãƒ¼ã‚¹
        let subtasks = try parseSubtaskList(from: content)
        
        return SubdivisionResponse(subtasks: subtasks)
    }
    
    private func parseSubtaskList(from content: String) throws -> [String] {
        // JSONé…åˆ—ã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹å®Ÿè£…
        // ä¾‹: ["ã‚¿ã‚¹ã‚¯1", "ã‚¿ã‚¹ã‚¯2", "ã‚¿ã‚¹ã‚¯3"]
        let jsonData = content.data(using: .utf8)!
        return try JSONDecoder().decode([String].self, from: jsonData)
    }
}
```

### 5.5 è‡ªç„¶è¨€èªè§£æãƒ­ã‚¸ãƒƒã‚¯

#### 5.5.1 NaturalLanguageParser

```swift
class NaturalLanguageParser {
    private let detector: NSDataDetector
    
    init() {
        detector = try! NSDataDetector(types: NSTextCheckingResult.CheckingType.date.rawValue)
    }
    
    struct ExtractionResult {
        let dateTime: Date?
        let taskType: TaskType?
    }
    
    // è‡ªç„¶è¨€èªã‹ã‚‰æ—¥æ™‚ã‚’æŠ½å‡º
    func extractDateTime(from text: String) -> ExtractionResult {
        let range = NSRange(text.startIndex..., in: text)
        let matches = detector.matches(in: text, options: [], range: range)
        
        guard let match = matches.first,
              let date = match.date else {
            return ExtractionResult(dateTime: nil, taskType: nil)
        }
        
        // ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã®åˆ¤å®š
        let taskType: TaskType
        if text.contains("ã¾ã§") || text.contains("æœŸé™") || text.contains("ç· åˆ‡") {
            taskType = .task
        } else if text.contains("ã«") || text.contains("æ™‚") || text.contains("é–‹å§‹") {
            taskType = .schedule
        } else {
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ã‚¿ã‚¹ã‚¯
            taskType = .task
        }
        
        return ExtractionResult(dateTime: date, taskType: taskType)
    }
}
```

### 5.6 ã‚«ãƒ†ã‚´ãƒªç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯

#### 5.6.1 CategoryManager

```swift
class CategoryManager {
    private let viewContext: NSManagedObjectContext
    
    init(viewContext: NSManagedObjectContext) {
        self.viewContext = viewContext
    }
    
    // ã‚«ãƒ†ã‚´ãƒªã‚’åå‰ã§æ¤œç´¢ã¾ãŸã¯ä½œæˆ
    func findOrCreateCategory(name: String, color: String = "#007AFF") -> Category {
        // æ—¢å­˜ã®ã‚«ãƒ†ã‚´ãƒªã‚’æ¤œç´¢
        let request: NSFetchRequest<Category> = Category.fetchRequest()
        request.predicate = NSPredicate(format: "name == %@", name)
        request.fetchLimit = 1
        
        if let existingCategory = try? viewContext.fetch(request).first {
            return existingCategory
        }
        
        // æ–°è¦ä½œæˆ
        let category = Category(context: viewContext)
        category.id = UUID()
        category.name = name
        category.color = color
        category.createdAt = Date()
        category.usageCount = 0
        
        return category
    }
    
    // ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã‚’å–å¾—ï¼ˆä½¿ç”¨å›æ•°é †ï¼‰
    func fetchCategories() -> [Category] {
        let request: NSFetchRequest<Category> = Category.fetchRequest()
        request.sortDescriptors = [
            NSSortDescriptor(key: "usageCount", ascending: false),
            NSSortDescriptor(key: "createdAt", ascending: false)
        ]
        
        do {
            return try viewContext.fetch(request)
        } catch {
            print("ã‚«ãƒ†ã‚´ãƒªå–å¾—ã‚¨ãƒ©ãƒ¼: \(error)")
            return []
        }
    }
    
    // ã‚«ãƒ†ã‚´ãƒªåã§æ¤œç´¢ï¼ˆã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆç”¨ï¼‰
    func searchCategories(query: String) -> [Category] {
        let request: NSFetchRequest<Category> = Category.fetchRequest()
        request.predicate = NSPredicate(format: "name CONTAINS[cd] %@", query)
        request.sortDescriptors = [
            NSSortDescriptor(key: "usageCount", ascending: false),
            NSSortDescriptor(key: "createdAt", ascending: false)
        ]
        
        do {
            return try viewContext.fetch(request)
        } catch {
            print("ã‚«ãƒ†ã‚´ãƒªæ¤œç´¢ã‚¨ãƒ©ãƒ¼: \(error)")
            return []
        }
    }
    
    // ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤
    func deleteCategory(_ category: Category) throws {
        viewContext.delete(category)
        try viewContext.save()
    }
    
    // ã‚«ãƒ†ã‚´ãƒªã®è‰²ã‚’æ›´æ–°
    func updateCategoryColor(_ category: Category, color: String) throws {
        category.color = color
        try viewContext.save()
    }
    
    // ã‚«ãƒ†ã‚´ãƒªåã‚’æ›´æ–°
    func updateCategoryName(_ category: Category, name: String) throws {
        category.name = name
        try viewContext.save()
    }
}
```

**æ©Ÿèƒ½è©³ç´°**
- **ã‚«ãƒ†ã‚´ãƒªã®æ¤œç´¢ãƒ»ä½œæˆ**: åå‰ã§æ—¢å­˜ã‚«ãƒ†ã‚´ãƒªã‚’æ¤œç´¢ã—ã€å­˜åœ¨ã—ãªã„å ´åˆã¯æ–°è¦ä½œæˆ
- **ã‚«ãƒ†ã‚´ãƒªä¸€è¦§å–å¾—**: ä½¿ç”¨å›æ•°é †ã«ã‚½ãƒ¼ãƒˆã—ã¦å–å¾—ï¼ˆã‚ˆãä½¿ã†ã‚«ãƒ†ã‚´ãƒªã‚’ä¸Šä½ã«è¡¨ç¤ºï¼‰
- **ã‚«ãƒ†ã‚´ãƒªæ¤œç´¢**: ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆç”¨ã®éƒ¨åˆ†ä¸€è‡´æ¤œç´¢
- **ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤**: Core Dataã‹ã‚‰ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ï¼ˆé–¢é€£ã‚¿ã‚¹ã‚¯ã¨ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯Core Dataã®å‰Šé™¤ãƒ«ãƒ¼ãƒ«ã§å‡¦ç†ï¼‰
- **ã‚«ãƒ†ã‚´ãƒªæ›´æ–°**: åå‰ã¨è‰²ã®æ›´æ–°ã‚’ã‚µãƒãƒ¼ãƒˆ

**ã‚«ãƒ†ã‚´ãƒªã®è‰²ç®¡ç†**
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè‰²ã®ãƒ—ãƒªã‚»ãƒƒãƒˆã‚’æä¾›ï¼ˆ8è‰²ï¼‰
- HEXã‚³ãƒ¼ãƒ‰å½¢å¼ã§ä¿å­˜
- SwiftUIã®Colorå‹ã¸ã®å¤‰æ›æ©Ÿèƒ½ã‚’æä¾›

### 5.7 ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯

#### 5.7.1 RepeatingTaskGenerator

**è¨­è¨ˆæ–¹é‡: ãƒ­ãƒ¼ãƒªãƒ³ã‚°ç”Ÿæˆæ–¹å¼**
- ã‚¿ã‚¹ã‚¯ç™»éŒ²æ™‚ã«å…¨ã¦ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã®ã§ã¯ãªãã€å¸¸ã«ã€Œæ¬¡ã®2-3å›åˆ†ã€ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç¶­æŒ
- 1ã¤å®Œäº†ã—ãŸã‚‰ã€æ¬¡ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
- iOSé€šçŸ¥64å€‹åˆ¶é™ã«ã‚‚å¯¾å¿œ

```swift
class RepeatingTaskGenerator {
    private let taskManager: TaskManager
    private let notificationManager: NotificationManager

    // ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã®åˆæœŸåŒ–ï¼ˆæœ€åˆã®2-3å›åˆ†ã‚’ç”Ÿæˆï¼‰
    func initializeRepeatingTask(for parentTask: Task) async throws {
        guard parentTask.isRepeating,
              let pattern = parentTask.repeatPattern else { return }

        // æœ€åˆã®3å›åˆ†ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
        let maxInstances = 3
        var generatedCount = 0
        var currentDate = parentTask.deadline ?? parentTask.startDateTime ?? Date()

        while generatedCount < maxInstances {
            let nextDate = calculateNextDate(from: currentDate, pattern: pattern)

            // ç¹°ã‚Šè¿”ã—çµ‚äº†æ—¥æ™‚ã®ãƒã‚§ãƒƒã‚¯
            if let endDate = parentTask.repeatEndDate, nextDate > endDate {
                break
            }

            // æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
            let nextTask = createTaskInstance(
                from: parentTask,
                nextDate: nextDate,
                pattern: pattern
            )

            try await taskManager.createTask(nextTask)

            currentDate = nextDate
            generatedCount += 1
        }
    }

    // ã‚¿ã‚¹ã‚¯å®Œäº†æ™‚ã«æ¬¡ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆï¼ˆãƒ­ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ï¼‰
    func onTaskCompleted(for task: Task) async throws {
        guard task.isRepeating,
              let pattern = task.repeatPattern else { return }

        // ç¾åœ¨ã®æœªå®Œäº†ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°ã‚’ç¢ºèª
        let parentId = task.parentTaskId ?? task.id
        let pendingInstances = try await taskManager.fetchPendingRepeatingInstances(
            parentTaskId: parentId
        )

        // æœªå®Œäº†ãŒ2å€‹æœªæº€ãªã‚‰ã€æ¬¡ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
        if pendingInstances.count < 2 {
            // æœ€å¾Œã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ—¥æ™‚ã‹ã‚‰æ¬¡ã®æ—¥æ™‚ã‚’è¨ˆç®—
            let lastDate = pendingInstances.last?.deadline
                ?? pendingInstances.last?.startDateTime
                ?? task.deadline
                ?? task.startDateTime
                ?? Date()

            let nextDate = calculateNextDate(from: lastDate, pattern: pattern)

            // ç¹°ã‚Šè¿”ã—çµ‚äº†æ—¥æ™‚ã®ãƒã‚§ãƒƒã‚¯
            if let endDate = task.repeatEndDate, nextDate > endDate {
                return // ç¹°ã‚Šè¿”ã—çµ‚äº†
            }

            // æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
            let nextTask = createTaskInstance(
                from: task,
                nextDate: nextDate,
                pattern: pattern
            )

            try await taskManager.createTask(nextTask)
        }
    }

    // ã‚¿ã‚¹ã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä½œæˆ
    private func createTaskInstance(
        from parentTask: Task,
        nextDate: Date,
        pattern: RepeatPattern
    ) -> Task {
        return Task(
            title: parentTask.title,
            category: parentTask.category,
            priority: parentTask.priority,
            taskType: parentTask.taskType,
            deadline: parentTask.taskType == .task ? nextDate : nil,
            startDateTime: parentTask.taskType == .schedule ? nextDate : nil,
            alarmEnabled: parentTask.alarmEnabled,
            alarmDateTime: parentTask.alarmDateTime.map {
                addIntervalToAlarm($0, nextDate: nextDate, originalDate: parentTask.deadline ?? parentTask.startDateTime!)
            },
            reminderEnabled: parentTask.reminderEnabled,
            reminderInterval: parentTask.reminderInterval,
            isRepeating: true,
            repeatPattern: pattern,
            repeatEndDate: parentTask.repeatEndDate,
            parentTaskId: parentTask.parentTaskId ?? parentTask.id
        )
    }

    // ã‚¢ãƒ©ãƒ¼ãƒ æ™‚åˆ»ã®èª¿æ•´
    private func addIntervalToAlarm(_ originalAlarm: Date, nextDate: Date, originalDate: Date) -> Date {
        let interval = originalAlarm.timeIntervalSince(originalDate)
        return nextDate.addingTimeInterval(interval)
    }

    // æ¬¡å›æ—¥æ™‚ã®è¨ˆç®—
    private func calculateNextDate(from date: Date, pattern: RepeatPattern) -> Date {
        let calendar = Calendar.current

        switch pattern.type {
        case .daily:
            return calendar.date(byAdding: .day, value: 1, to: date)!

        case .weekly:
            return calendar.date(byAdding: .weekOfYear, value: 1, to: date)!

        case .monthly:
            return calendar.date(byAdding: .month, value: 1, to: date)!

        case .yearly:
            return calendar.date(byAdding: .year, value: 1, to: date)!

        case .everyNDays:
            guard let interval = pattern.interval else { return date }
            return calendar.date(byAdding: .day, value: interval, to: date)!

        case .nthWeekdayOfMonth:
            guard let weekday = pattern.weekday, let week = pattern.week else { return date }
            return calculateNthWeekday(weekday: weekday, week: week, from: date)

        case .custom:
            // ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å‡¦ç†
            return date
        }
    }

    // æ¯æœˆç¬¬Næ›œæ—¥ã®è¨ˆç®—
    private func calculateNthWeekday(weekday: Int, week: Int, from date: Date) -> Date {
        let calendar = Calendar.current
        var components = calendar.dateComponents([.year, .month], from: date)

        // æ¬¡ã®æœˆã«é€²ã‚€
        components.month! += 1

        let firstDayOfMonth = calendar.date(from: components)!
        let firstWeekday = calendar.component(.weekday, from: firstDayOfMonth)

        // ç›®çš„ã®æ›œæ—¥ã¾ã§ã®æ—¥æ•°ã‚’è¨ˆç®—
        var daysToAdd = (weekday - firstWeekday + 7) % 7
        daysToAdd += (week - 1) * 7

        return calendar.date(byAdding: .day, value: daysToAdd, to: firstDayOfMonth)!
    }
}
```

**ãƒã‚¤ãƒ³ãƒˆ:**
1. å¸¸ã«æœªå®Œäº†ã®ç¹°ã‚Šè¿”ã—ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒ2-3å€‹ã‚ã‚‹çŠ¶æ…‹ã‚’ç¶­æŒ
2. ã‚¿ã‚¹ã‚¯å®Œäº†æ™‚ã«æ¬¡ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å‹•çš„ã«ç”Ÿæˆ
3. é€šçŸ¥æ•°ã‚‚åˆ¶é™å†…ã«åã¾ã‚Šã‚„ã™ã„
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã¯ã€Œå°†æ¥ã®ã‚¿ã‚¹ã‚¯ãŒè‡ªå‹•ã§ç¾ã‚Œã‚‹ã€ã‚ˆã†ã«è¦‹ãˆã‚‹

**ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®å‡¦ç†:**

1. **è¦ªã‚¿ã‚¹ã‚¯å‰Šé™¤æ™‚ã®å‡¦ç†:**
   - è¦ªã‚¿ã‚¹ã‚¯ãŒå‰Šé™¤ã•ã‚ŒãŸå ´åˆã€é–¢é€£ã™ã‚‹å…¨ã¦ã®å­ã‚¿ã‚¹ã‚¯ï¼ˆç¹°ã‚Šè¿”ã—ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼‰ã‚‚ä¸€ç·’ã«å‰Šé™¤ï¼ˆã‚«ã‚¹ã‚±ãƒ¼ãƒ‰å‰Šé™¤ï¼‰
   - Core Dataã®delete ruleã‚’`Cascade`ã«è¨­å®šã™ã‚‹ã“ã¨ã§è‡ªå‹•çš„ã«å‰Šé™¤ã•ã‚Œã‚‹
   - TaskManager.deleteTask()ã®å®Ÿè£…:
     ```swift
     func deleteTask(_ task: Task) async throws {
         // 1. é€šçŸ¥ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
         try await notificationManager.cancelNotifications(for: task)

         // 2. ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã®å ´åˆã€å…¨ã¦ã®å­ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—ã—ã¦å‰Šé™¤
         if task.isRepeating {
             let parentId = task.parentTaskId ?? task.id
             let childTasks = try await repository.fetchRepeatingInstances(parentTaskId: parentId)
             for childTask in childTasks {
                 try await notificationManager.cancelNotifications(for: childTask)
                 try await repository.delete(childTask)
             }
         }

         // 3. ã‚¿ã‚¹ã‚¯æœ¬ä½“ã‚’å‰Šé™¤
         try await repository.delete(task)
     }
     ```

2. **æœŸé™è¶…éæ™‚ã®å‡¦ç†:**
   - ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã•ã‚Œãšã«æœŸé™ã‚’éããŸå ´åˆã§ã‚‚ã€æ¬¡ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
   - æœªå®Œäº†ã®æœŸé™è¶…éã‚¿ã‚¹ã‚¯ã¯æ®‹ã‚Šç¶šã‘ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§å®Œäº†ã¾ãŸã¯å‰Šé™¤ã™ã‚‹ã¾ã§å­˜åœ¨ã™ã‚‹
   - æ¬¡ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯æœŸé™è¶…éã®æœ‰ç„¡ã«é–¢ã‚ã‚‰ãšç”Ÿæˆã•ã‚Œã‚‹
   - ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¤ã„ã‚¿ã‚¹ã‚¯ã‚’å¿˜ã‚Œã¦ã‚‚æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯è¡¨ç¤ºã•ã‚Œç¶šã‘ã‚‹

3. **parentTaskIdãŒnilã®å ´åˆã®å‡¦ç†:**
   - `onTaskCompleted()`ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§æ—¢ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’å®Ÿè£…æ¸ˆã¿:
     ```swift
     let parentId = task.parentTaskId ?? task.id
     ```
   - parentTaskIdãŒnilã®å ´åˆã€ã‚¿ã‚¹ã‚¯è‡ªèº«ã®IDã‚’ä½¿ç”¨
   - ã“ã‚Œã«ã‚ˆã‚Šã€æœ€åˆã®ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚‚æ­£å¸¸ã«å‹•ä½œã™ã‚‹

---

## 6. APIè¨­è¨ˆ

### 6.1 LLM APIä»•æ§˜

#### 6.1.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- **URL**: `https://api.openai.com/v1/chat/completions`ï¼ˆä¾‹ï¼‰
- **ãƒ¡ã‚½ãƒƒãƒ‰**: POST
- **èªè¨¼**: Bearer Token

#### 6.1.2 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "model": "gpt-3.5-turbo",
  "messages": [
    {
      "role": "user",
      "content": "ä»¥ä¸‹ã®ã‚¿ã‚¹ã‚¯ã‚’3-5å€‹ã®å°ã•ãªã‚¿ã‚¹ã‚¯ã«ç´°åˆ†åŒ–ã—ã¦ãã ã•ã„ã€‚\nå„ã‚¿ã‚¹ã‚¯ã¯å…·ä½“çš„ã§å®Ÿè¡Œå¯èƒ½ãªã‚‚ã®ã«ã—ã¦ãã ã•ã„ã€‚\n\nã‚¿ã‚¹ã‚¯: éƒ¨å±‹ã®æƒé™¤\n\nå‡ºåŠ›å½¢å¼: JSONé…åˆ—ï¼ˆå„è¦ç´ ã¯ã‚¿ã‚¹ã‚¯åã®æ–‡å­—åˆ—ï¼‰"
    }
  ],
  "temperature": 0.7,
  "max_tokens": 500
}
```

#### 6.1.3 ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "id": "chatcmpl-xxx",
  "object": "chat.completion",
  "created": 1234567890,
  "model": "gpt-3.5-turbo",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "[\"åºŠã‚’æƒé™¤æ©Ÿã§ã‹ã‘ã‚‹\", \"çª“ã‚’æ‹­ã\", \"ã‚´ãƒŸã‚’æ¨ã¦ã‚‹\", \"æœºã‚’æ•´ç†ã™ã‚‹\"]"
      },
      "finish_reason": "stop"
    }
  ]
}
```

#### 6.1.4 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼**: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ10ç§’ã€ãƒªãƒˆãƒ©ã‚¤3å›ã¾ã§
- **APIã‚¨ãƒ©ãƒ¼**: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤º
- **ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç´°åˆ†åŒ–æ¡ˆã‚’æç¤º

---

## 7. é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ

### 7.1 é€šçŸ¥ã‚«ãƒ†ã‚´ãƒªå®šç¾©

```swift
extension UNNotificationCategory {
    static let alarm = UNNotificationCategory(
        identifier: "ALARM",
        actions: [
            UNNotificationAction(
                identifier: "SNOOZE",
                title: "ã‚¹ãƒŒãƒ¼ã‚º",
                options: []
            ),
            UNNotificationAction(
                identifier: "COMPLETE",
                title: "å®Œäº†",
                options: [.foreground]
            ),
            UNNotificationAction(
                identifier: "OPEN",
                title: "ã‚¢ãƒ—ãƒªã‚’é–‹ã",
                options: [.foreground]
            )
        ],
        intentIdentifiers: [],
        options: []
    )
    
    static let reminder = UNNotificationCategory(
        identifier: "REMINDER",
        actions: [
            UNNotificationAction(
                identifier: "SNOOZE",
                title: "ã‚¹ãƒŒãƒ¼ã‚º",
                options: []
            ),
            UNNotificationAction(
                identifier: "COMPLETE",
                title: "å®Œäº†",
                options: [.foreground]
            ),
            UNNotificationAction(
                identifier: "STOP",
                title: "åœæ­¢",
                options: []
            ),
            UNNotificationAction(
                identifier: "OPEN",
                title: "ã‚¢ãƒ—ãƒªã‚’é–‹ã",
                options: [.foreground]
            )
        ],
        intentIdentifiers: [],
        options: []
    )
}
```

### 7.2 é€šçŸ¥ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†

```swift
class NotificationActionHandler: NSObject, UNUserNotificationCenterDelegate {
    private let taskManager: TaskManager
    private let notificationManager: NotificationManager
    
    func userNotificationCenter(
        _ center: UNUserNotificationCenter,
        didReceive response: UNNotificationResponse,
        withCompletionHandler completionHandler: @escaping () -> Void
    ) {
        let taskId = extractTaskId(from: response.notification)
        guard let task = taskManager.fetchTask(id: taskId) else {
            completionHandler()
            return
        }
        
        switch response.actionIdentifier {
        case "SNOOZE":
            Task {
                try? await notificationManager.snoozeReminder(for: task)
            }
            
        case "COMPLETE":
            // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºï¼ˆUIå±¤ã§å‡¦ç†ï¼‰
            showCompletionConfirmation(for: task)
            
        case "STOP":
            // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºï¼ˆUIå±¤ã§å‡¦ç†ï¼‰
            showStopConfirmation(for: task)
            
        case "OPEN":
            // ã‚¢ãƒ—ãƒªã‚’é–‹ã„ã¦ã‚¿ã‚¹ã‚¯è©³ç´°ç”»é¢ã‚’è¡¨ç¤º
            openTaskDetail(task)
            
        default:
            break
        }
        
        completionHandler()
    }
}
```

---

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 8.1 ã‚¨ãƒ©ãƒ¼å®šç¾©

```swift
enum TaskError: LocalizedError {
    case invalidTitle
    case invalidDateTime
    case conflictingDates                // é–‹å§‹æ—¥æ™‚ > æœŸé™ã®å ´åˆ
    case pastDate                        // éå»ã®æ—¥æ™‚ã‚’è¨­å®š
    case taskNotFound
    case saveFailed
    case invalidRepeatPattern            // ç¹°ã‚Šè¿”ã—è¨­å®šãŒç„¡åŠ¹

    var errorDescription: String? {
        switch self {
        case .invalidTitle:
            return "ã‚¿ã‚¹ã‚¯åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
        case .invalidDateTime:
            return "æ—¥æ™‚è¨­å®šãŒç„¡åŠ¹ã§ã™"
        case .conflictingDates:
            return "é–‹å§‹æ—¥æ™‚ã¯æœŸé™ã‚ˆã‚Šå‰ã«è¨­å®šã—ã¦ãã ã•ã„"
        case .pastDate:
            return "éå»ã®æ—¥æ™‚ã¯è¨­å®šã§ãã¾ã›ã‚“"
        case .taskNotFound:
            return "ã‚¿ã‚¹ã‚¯ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
        case .saveFailed:
            return "ã‚¿ã‚¹ã‚¯ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ"
        case .invalidRepeatPattern:
            return "ç¹°ã‚Šè¿”ã—è¨­å®šãŒç„¡åŠ¹ã§ã™ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
        }
    }
}

enum NotificationError: LocalizedError {
    case authorizationDenied
    case schedulingFailed
    case maxSnoozeReached
    case notificationLimitReached        // iOS 64å€‹åˆ¶é™
    case invalidScheduleTime             // éå»ã®æ™‚åˆ»
    case duplicateNotification           // é‡è¤‡ã™ã‚‹é€šçŸ¥

    var errorDescription: String? {
        switch self {
        case .authorizationDenied:
            return "é€šçŸ¥ã®è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨­å®šã‚¢ãƒ—ãƒªã‹ã‚‰é€šçŸ¥ã‚’è¨±å¯ã—ã¦ãã ã•ã„"
        case .schedulingFailed:
            return "é€šçŸ¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¤±æ•—ã—ã¾ã—ãŸ"
        case .maxSnoozeReached:
            return "ã‚¹ãƒŒãƒ¼ã‚ºã®æœ€å¤§å›æ•°ã«é”ã—ã¾ã—ãŸ"
        case .notificationLimitReached:
            return "é€šçŸ¥æ•°ã®ä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚å¤ã„ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã—ã¦ãã ã•ã„"
        case .invalidScheduleTime:
            return "éå»ã®æ™‚åˆ»ã«ã¯é€šçŸ¥ã‚’è¨­å®šã§ãã¾ã›ã‚“"
        case .duplicateNotification:
            return "æ—¢ã«åŒã˜é€šçŸ¥ãŒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™"
        }
    }
}

enum APIError: LocalizedError {
    case networkError
    case invalidResponse
    case timeout
    case rateLimitExceeded               // ä½¿ç”¨é‡åˆ¶é™è¶…é
    case invalidAPIKey                   // APIã‚­ãƒ¼ãŒç„¡åŠ¹
    case quotaExceeded                   // APIã‚¯ã‚©ãƒ¼ã‚¿è¶…é

    var errorDescription: String? {
        switch self {
        case .networkError:
            return "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„"
        case .invalidResponse:
            return "ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”ãŒç„¡åŠ¹ã§ã™"
        case .timeout:
            return "ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„"
        case .rateLimitExceeded:
            return "æœ¬æ—¥ã®ç´°åˆ†åŒ–å›æ•°ä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚æ˜æ—¥å†åº¦ãŠè©¦ã—ãã ã•ã„"
        case .invalidAPIKey:
            return "APIã‚­ãƒ¼ãŒç„¡åŠ¹ã§ã™ã€‚é–‹ç™ºè€…ã«é€£çµ¡ã—ã¦ãã ã•ã„"
        case .quotaExceeded:
            return "APIã®ä½¿ç”¨é‡ä¸Šé™ã«é”ã—ã¾ã—ãŸ"
        }
    }
}

enum DataError: LocalizedError {
    case corruptedData                   // ãƒ‡ãƒ¼ã‚¿ç ´æ
    case migrationFailed                 // ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—
    case storageFullError                // ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ä¸è¶³

    var errorDescription: String? {
        switch self {
        case .corruptedData:
            return "ãƒ‡ãƒ¼ã‚¿ãŒç ´æã—ã¦ã„ã¾ã™ã€‚å¾©å…ƒã‚’è©¦ã¿ã¦ãã ã•ã„"
        case .migrationFailed:
            return "ãƒ‡ãƒ¼ã‚¿ã®ç§»è¡Œã«å¤±æ•—ã—ã¾ã—ãŸ"
        case .storageFullError:
            return "ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ãŒä¸è¶³ã—ã¦ã„ã¾ã™"
        }
    }
}
```

### 8.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º**
2. **ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ãªæ“ä½œã¯è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤**
3. **è‡´å‘½çš„ãªã‚¨ãƒ©ãƒ¼ã¯ãƒ­ã‚°ã«è¨˜éŒ²**
4. **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œã‚’å¯èƒ½ã«ã™ã‚‹**

### 8.3 å¤šè¨€èªå¯¾å¿œ

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å¤šè¨€èªåŒ–:**
- ç¾åœ¨ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ—¥æœ¬èªã§ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ãŒã€å°†æ¥çš„ãªå¤šè¨€èªå¯¾å¿œã‚’è€ƒæ…®ã—ãŸè¨­è¨ˆã‚’æ¨å¥¨
- `Localizable.strings`ã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤–éƒ¨åŒ–
- å®Ÿè£…ä¾‹:
  ```swift
  // Localizable.strings (Japanese)
  "task_error_invalid_title" = "ã‚¿ã‚¹ã‚¯åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„";
  "notification_error_authorization_denied" = "é€šçŸ¥ã®è¨±å¯ãŒå¿…è¦ã§ã™ã€‚è¨­å®šã‚¢ãƒ—ãƒªã‹ã‚‰é€šçŸ¥ã‚’è¨±å¯ã—ã¦ãã ã•ã„";

  // ã‚¨ãƒ©ãƒ¼å®šç¾©ã§ã®ä½¿ç”¨
  var errorDescription: String? {
      switch self {
      case .invalidTitle:
          return NSLocalizedString("task_error_invalid_title", comment: "")
      case .authorizationDenied:
          return NSLocalizedString("notification_error_authorization_denied", comment: "")
      }
  }
  ```
- Phase 1ã§ã¯æ—¥æœ¬èªã®ã¿å®Ÿè£…ã—ã€Phase 2ä»¥é™ã§å¤šè¨€èªå¯¾å¿œã‚’æ¤œè¨

---

## 9. ãƒ†ã‚¹ãƒˆä»•æ§˜

### 9.1 å˜ä½“ãƒ†ã‚¹ãƒˆ

#### 9.1.1 TaskManagerãƒ†ã‚¹ãƒˆ
- ã‚¿ã‚¹ã‚¯ä½œæˆã®æˆåŠŸã‚±ãƒ¼ã‚¹
- ã‚¿ã‚¹ã‚¯ä½œæˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
- ã‚¿ã‚¹ã‚¯å®Œäº†ã®æˆåŠŸã‚±ãƒ¼ã‚¹
- ã‚¿ã‚¹ã‚¯å‰Šé™¤ã®æˆåŠŸã‚±ãƒ¼ã‚¹

#### 9.1.2 ReminderServiceãƒ†ã‚¹ãƒˆ
- ãƒªãƒã‚¤ãƒ³ãƒ‰é–“éš”ã®è¨ˆç®—ï¼ˆå„é‡è¦åº¦ãƒ»ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ï¼‰
- æ®µéšçš„ãƒªãƒã‚¤ãƒ³ãƒ‰é–“éš”ã®è¨ˆç®—
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®é–‹å§‹æ—¥æ™‚å‰ã‹ã‚‰ã®ãƒªãƒã‚¤ãƒ³ãƒ‰

#### 9.1.3 NaturalLanguageParserãƒ†ã‚¹ãƒˆ
- æ—¥æ™‚æŠ½å‡ºã®æˆåŠŸã‚±ãƒ¼ã‚¹
- ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã®åˆ¤å®š
- æ—¥æ™‚æŠ½å‡ºã®å¤±æ•—ã‚±ãƒ¼ã‚¹

### 9.2 çµ±åˆãƒ†ã‚¹ãƒˆ

#### 9.2.1 ã‚¿ã‚¹ã‚¯ç™»éŒ²ãƒ•ãƒ­ãƒ¼
1. ã‚¿ã‚¹ã‚¯ç™»éŒ²ç”»é¢ã§ã‚¿ã‚¹ã‚¯ã‚’å…¥åŠ›
2. ä¿å­˜ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
3. ã‚¿ã‚¹ã‚¯ä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
4. é€šçŸ¥ãŒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

#### 9.2.2 ãƒªãƒã‚¤ãƒ³ãƒ‰é€šçŸ¥ãƒ•ãƒ­ãƒ¼
1. ãƒªãƒã‚¤ãƒ³ãƒ‰è¨­å®šæ¸ˆã¿ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ
2. é€šçŸ¥ãŒé€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
3. ã‚¹ãƒŒãƒ¼ã‚ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
4. æ¬¡ã®ãƒªãƒã‚¤ãƒ³ãƒ‰ãŒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### 9.3 UIãƒ†ã‚¹ãƒˆ

#### 9.3.1 ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢
- ã‚¿ã‚¹ã‚¯ã®è¡¨ç¤º
- ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½
- ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
- ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

#### 9.3.2 ã‚¿ã‚¹ã‚¯ç™»éŒ²ç”»é¢
- å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹•ä½œ
- è‡ªç„¶è¨€èªè§£æã®å‹•ä½œ
- ãƒ—ãƒªã‚»ãƒƒãƒˆæ™‚é–“ã®é¸æŠ
- ä¿å­˜å‡¦ç†

### 9.4 ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™

**ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰å°‚ç”¨ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆæ©Ÿèƒ½:**

1. **å®Ÿè£…æ–¹é‡:**
   - ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰ã§ã®ã¿æœ‰åŠ¹ãªãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆæ©Ÿèƒ½ã‚’è¿½åŠ 
   - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ•ãƒ©ã‚°ï¼ˆ`#if DEBUG`ï¼‰ã§æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã‹ã‚‰é™¤å¤–
   - é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆæ™‚ã®åŠ¹ç‡åŒ–ã‚’ç›®çš„

2. **å®Ÿè£…ä¾‹:**
   ```swift
   #if DEBUG
   class TestDataGenerator {
       static func generateSampleTasks() {
           let sampleTasks = [
               Task(title: "è²·ã„ç‰©ã«è¡Œã", priority: .high, deadline: Date().addingTimeInterval(3600)),
               Task(title: "ãƒ¬ãƒãƒ¼ãƒˆã‚’æ›¸ã", priority: .medium, deadline: Date().addingTimeInterval(86400)),
               Task(title: "æƒé™¤ã‚’ã™ã‚‹", priority: .low, deadline: Date().addingTimeInterval(172800))
           ]

           for task in sampleTasks {
               try? TaskManager.shared.createTask(task)
           }
       }

       static func clearAllData() {
           // å…¨ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤
           try? TaskManager.shared.deleteAllTasks()
       }
   }
   #endif
   ```

3. **ä½¿ç”¨æ–¹æ³•:**
   - è¨­å®šç”»é¢ã«ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ ï¼ˆãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰ã®ã¿è¡¨ç¤ºï¼‰
   - ã€Œã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã€ãƒœã‚¿ãƒ³
   - ã€Œå…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã€ãƒœã‚¿ãƒ³
   - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå‰ã®åˆæœŸçŠ¶æ…‹ä½œæˆã«æ´»ç”¨

4. **æ³¨æ„äº‹é …:**
   - æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã«ã¯å«ã¾ã‚Œãªã„ï¼ˆ`#if DEBUG`ã§é™¤å¤–ï¼‰
   - TestFlightãƒ“ãƒ«ãƒ‰ã§ã‚‚ç„¡åŠ¹åŒ–
   - ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼æƒ…å ±ã¯å«ã¾ãªã„

---

## 10. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 10.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¨­å®šï¼ˆid, createdAt, deadline, startDateTimeï¼‰
- ãƒãƒƒãƒå‡¦ç†ã®å®Ÿè£…
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ï¼ˆå¤§é‡ãƒ‡ãƒ¼ã‚¿å¯¾å¿œï¼‰

### 10.2 é€šçŸ¥æœ€é©åŒ–

#### 10.2.1 iOSé€šçŸ¥64å€‹åˆ¶é™ã¸ã®å¯¾å¿œ
**åˆ¶ç´„:**
- iOS ã§ã¯1ã‚¢ãƒ—ãƒªã‚ãŸã‚Šæœ€å¤§64å€‹ã®ãƒ­ãƒ¼ã‚«ãƒ«é€šçŸ¥ã—ã‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ããªã„
- ã“ã®åˆ¶é™ã‚’è¶…ãˆã‚‹ã¨ã€æ–°ã—ã„é€šçŸ¥ãŒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚Œãšã€å¤ã„é€šçŸ¥ãŒå‰Šé™¤ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

**å¯¾å¿œç­–: å‹•çš„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼**

```swift
class NotificationRefreshService {
    private let taskManager: TaskManager
    private let reminderService: ReminderService

    // ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«å‘¼ã³å‡ºã™
    func refreshNotifications() async throws {
        // 1. ç¾åœ¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ¸ˆã¿ã®é€šçŸ¥æ•°ã‚’ç¢ºèª
        let pendingRequests = await UNUserNotificationCenter.current()
            .pendingNotificationRequests()
        let currentCount = pendingRequests.count

        print("ç¾åœ¨ã®é€šçŸ¥æ•°: \(currentCount)/64")

        // 2. 64å€‹ã«è¿‘ã„å ´åˆã€å¤ã„é€šçŸ¥ã‚’å‰Šé™¤
        if currentCount > 50 {
            // éå»ã®é€šçŸ¥ã‚’å‰Šé™¤
            let outdatedNotifications = pendingRequests
                .filter { request in
                    guard let trigger = request.trigger as? UNCalendarNotificationTrigger,
                          let nextTriggerDate = trigger.nextTriggerDate() else {
                        return false
                    }
                    return nextTriggerDate < Date()
                }

            let outdatedIds = outdatedNotifications.map { $0.identifier }
            UNUserNotificationCenter.current()
                .removePendingNotificationRequests(withIdentifiers: outdatedIds)
        }

        // 3. ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ã‚¹ã‚¯ã‚’é‡è¦åº¦é †ã«å–å¾—
        let activeTasks = taskManager.fetchActiveTasks()
        let sortedTasks = activeTasks.sorted { task1, task2 in
            // é‡è¦åº¦é †: é«˜ > ä¸­ > ä½
            let priority1 = priorityValue(task1.priority)
            let priority2 = priorityValue(task2.priority)
            return priority1 > priority2
        }

        // 4. å„ªå…ˆåº¦ãƒ™ãƒ¼ã‚¹ã§é€šçŸ¥ã‚’å‰²ã‚Šå½“ã¦
        var remainingSlots = 64 - currentCount

        for task in sortedTasks {
            guard remainingSlots > 0 else { break }

            // æ—¢å­˜ã®é€šçŸ¥æ•°ã‚’ç¢ºèª
            let taskNotifications = pendingRequests.filter {
                $0.identifier.contains(task.id.uuidString)
            }

            // é‡è¦åº¦ã«å¿œã˜ãŸæœ€å¤§é€šçŸ¥æ•°ã‚’å–å¾—
            let maxNotifications: Int
            switch task.priority {
            case .high:
                maxNotifications = 15
            case .medium:
                maxNotifications = 10
            case .low:
                maxNotifications = 5
            }

            // ä¸è¶³ã—ã¦ã„ã‚‹é€šçŸ¥æ•°ã‚’è¨ˆç®—
            let currentTaskCount = taskNotifications.count
            let needed = max(0, maxNotifications - currentTaskCount)

            // æ®‹ã‚Šæ ã®ç¯„å›²å†…ã§é€šçŸ¥ã‚’è¿½åŠ 
            if needed > 0 && currentTaskCount < maxNotifications {
                try await reminderService.scheduleReminder(for: task)
                // å®Ÿéš›ã«è¿½åŠ ã•ã‚ŒãŸé€šçŸ¥æ•°ã‚’æ¸›ç®—ï¼ˆæœ€å¤§maxNotificationså€‹ï¼‰
                remainingSlots -= min(needed, remainingSlots)
            }
        }

        print("é€šçŸ¥ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥å®Œäº†: æ®‹ã‚Šæ  \(remainingSlots)")
    }

    // é‡è¦åº¦ã‚’æ•°å€¤ã«å¤‰æ›ï¼ˆé«˜>ä¸­>ä½ï¼‰
    private func priorityValue(_ priority: Priority) -> Int {
        switch priority {
        case .high: return 3
        case .medium: return 2
        case .low: return 1
        }
    }
}
```

**å®Ÿè£…ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆæ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼‰:**

**Phase 1ï¼ˆåˆæœŸå®Ÿè£…ï¼‰:**
1. **ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚**: `application(_:didFinishLaunchingWithOptions:)` ã§å‘¼ã³å‡ºã—
2. **ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å¾©å¸°æ™‚**: `applicationWillEnterForeground(_:)` ã§å‘¼ã³å‡ºã—
3. **ã‚¿ã‚¹ã‚¯å®Œäº†æ™‚**: ä¸è¦ã«ãªã£ãŸé€šçŸ¥ã‚’å‰Šé™¤ã—ã€ä»–ã®ã‚¿ã‚¹ã‚¯ã®é€šçŸ¥ã‚’è¿½åŠ 

**Phase 2ä»¥é™ï¼ˆå°†æ¥ã®æ‹¡å¼µï¼‰:**
- **ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°**: `BGTaskScheduler` ã§å®šæœŸçš„ã«å®Ÿè¡Œï¼ˆ12æ™‚é–“ã”ã¨ãªã©ï¼‰
  - Info.plistã«`BGTaskSchedulerPermittedIdentifiers`ã‚’è¿½åŠ 
  - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯ã®ç™»éŒ²ã¨å®Ÿè¡Œå‡¦ç†ã‚’å®Ÿè£…
  - æ³¨æ„: BGTaskSchedulerã¯ç¢ºå®Ÿã«å®Ÿè¡Œã•ã‚Œã‚‹ã¨ã¯é™ã‚‰ãªã„ãŸã‚ã€Phase 1ã®å®Ÿè£…ã§åŸºæœ¬æ©Ÿèƒ½ã‚’ç¢ºä¿

**Phase 1ã‚’æ¨å¥¨ã™ã‚‹ç†ç”±:**
- BGTaskSchedulerã®å®Ÿè£…ãŒè¤‡é›‘ï¼ˆInfo.plistè¨­å®šã€ç™»éŒ²å‡¦ç†ãªã©ï¼‰
- ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°ã¯ç¢ºå®Ÿæ€§ãŒä½ã„ï¼ˆã‚·ã‚¹ãƒ†ãƒ åˆ¤æ–­ã§å®Ÿè¡Œã•ã‚Œãªã„å¯èƒ½æ€§ï¼‰
- ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ï¼‹ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å¾©å¸°æ™‚ã®æ›´æ–°ã§ã€ã»ã¨ã‚“ã©ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¯¾å¿œå¯èƒ½
- é–‹ç™ºåˆæœŸã¯å®Ÿè£…ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ä¿ã¤ã“ã¨ã§ãƒ‡ãƒãƒƒã‚°ãŒå®¹æ˜“

**å„ªå…ˆåº¦ã®ç®¡ç†:**
- é‡è¦åº¦ã€Œé«˜ã€ã®ã‚¿ã‚¹ã‚¯: ã‚ˆã‚Šå¤šãã®é€šçŸ¥ã‚’å‰²ã‚Šå½“ã¦ï¼ˆæœ€å¤§15å€‹ï¼‰
- é‡è¦åº¦ã€Œä¸­ã€ã®ã‚¿ã‚¹ã‚¯: æ¨™æº–ï¼ˆæœ€å¤§10å€‹ï¼‰
- é‡è¦åº¦ã€Œä½ã€ã®ã‚¿ã‚¹ã‚¯: æœ€å°é™ï¼ˆæœ€å¤§5å€‹ï¼‰

**å…¨ä½“åˆ¶é™ï¼ˆ64å€‹ï¼‰ã¸ã®å¯¾å¿œ:**
- å…¨ã‚¿ã‚¹ã‚¯ã®é€šçŸ¥æ•°ã®åˆè¨ˆãŒ64å€‹ã«è¿‘ã¥ã„ãŸå ´åˆã€å„ªå…ˆåº¦ã«åŸºã¥ã„ã¦å‹•çš„ã«èª¿æ•´
- èª¿æ•´ã®å„ªå…ˆé †ä½:
  1. é‡è¦åº¦ã€Œé«˜ã€ã®ã‚¿ã‚¹ã‚¯: æœ€å„ªå…ˆã§é€šçŸ¥ã‚’ç¢ºä¿ï¼ˆæœ€å¤§15å€‹ã¾ã§ï¼‰
  2. é‡è¦åº¦ã€Œä¸­ã€ã®ã‚¿ã‚¹ã‚¯: æ¬¡ã«å„ªå…ˆï¼ˆæ®‹ã‚Šæ ã®ç¯„å›²ã§æœ€å¤§10å€‹ã¾ã§ï¼‰
  3. é‡è¦åº¦ã€Œä½ã€ã®ã‚¿ã‚¹ã‚¯: æœ€å¾Œã«å‰²ã‚Šå½“ã¦ï¼ˆæ®‹ã‚Šæ ã®ç¯„å›²ã§æœ€å¤§5å€‹ã¾ã§ï¼‰
- 64å€‹åˆ¶é™ã«é”ã—ãŸå ´åˆã€é‡è¦åº¦ã€Œä½ã€ã®ã‚¿ã‚¹ã‚¯ã®é€šçŸ¥æ•°ã‚’å„ªå…ˆçš„ã«å‰Šæ¸›

#### 10.2.2 é€šçŸ¥ã®ä¸€æ‹¬ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
- è¤‡æ•°ã®ã‚¿ã‚¹ã‚¯ã®é€šçŸ¥ã‚’ã¾ã¨ã‚ã¦å‡¦ç†
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³çš„ãªå‡¦ç†ã§ä¸€è²«æ€§ã‚’ä¿ã¤

#### 10.2.3 ä¸è¦ãªé€šçŸ¥ã®å‰Šé™¤
- ã‚¿ã‚¹ã‚¯å®Œäº†æ™‚ã«å³åº§ã«å‰Šé™¤
- å®šæœŸçš„ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†

#### 10.2.4 é€šçŸ¥IDã®åŠ¹ç‡çš„ãªç®¡ç†
- **ã‚¢ãƒ©ãƒ¼ãƒ é€šçŸ¥ã®å‘½åè¦å‰‡**: `alarm_{taskId}`
  - ä¾‹: `alarm_123e4567-e89b-12d3-a456-426614174000`
  - ã‚¢ãƒ©ãƒ¼ãƒ ã¯1ã¤ã®ã‚¿ã‚¹ã‚¯ã«ã¤ã1å€‹ã®ã¿ãªã®ã§ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä¸è¦
- **ãƒªãƒã‚¤ãƒ³ãƒ‰é€šçŸ¥ã®å‘½åè¦å‰‡**: `reminder_{taskId}_{timestamp}`
  - ä¾‹: `reminder_123e4567-e89b-12d3-a456-426614174000_1704067200`
  - ãƒªãƒã‚¤ãƒ³ãƒ‰ã¯è¤‡æ•°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚Œã‚‹ãŸã‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§è­˜åˆ¥
- ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆ`alarm_`ã¾ãŸã¯`reminder_`ï¼‰ã¨ã‚¿ã‚¹ã‚¯IDã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯èƒ½

### 10.3 UIæœ€é©åŒ–
- ãƒªã‚¹ãƒˆã®é…å»¶èª­ã¿è¾¼ã¿
- ç”»åƒãƒ»ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®æœ€é©åŒ–

---

## 11. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼

### 11.1 ãƒ‡ãƒ¼ã‚¿ä¿è­·
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–ï¼ˆCore Data/SwiftDataï¼‰
- APIã‚­ãƒ¼ã®å®‰å…¨ãªä¿å­˜ï¼ˆKeychainï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ç«¯æœ«å†…ä¿å­˜

### 11.2 ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼
- LLM APIå‘¼ã³å‡ºã—æ™‚ã®æ˜ç¤ºçš„ãªé€šçŸ¥
- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã®æä¾›
- ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã®æœ€å°åŒ–ï¼ˆã‚¿ã‚¹ã‚¯åã®ã¿ï¼‰

---

## 12. ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥

### 12.1 Core Data ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**åˆæœŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆv1.0ï¼‰:**
- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¦ï¼ˆåˆç‰ˆï¼‰

**å°†æ¥ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—æ™‚:**

1. **è»½é‡ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆLightweight Migrationï¼‰ã‚’æ¨å¥¨:**
   - å¯¾å¿œå¯èƒ½ãªå¤‰æ›´:
     - æ–°ã—ã„å±æ€§ã®è¿½åŠ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šï¼‰
     - å±æ€§ã®å‰Šé™¤
     - å±æ€§åã®å¤‰æ›´ï¼ˆãƒªãƒãƒ¼ãƒŸãƒ³ã‚°IDã‚’ä½¿ç”¨ï¼‰
     - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£åã®å¤‰æ›´ï¼ˆãƒªãƒãƒ¼ãƒŸãƒ³ã‚°IDã‚’ä½¿ç”¨ï¼‰
     - æ–°ã—ã„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®è¿½åŠ 
   - å®Ÿè£…:
     ```swift
     let container = NSPersistentContainer(name: "Moriminder")
     let description = container.persistentStoreDescriptions.first
     description?.shouldMigrateStoreAutomatically = true
     description?.shouldInferMappingModelAutomatically = true
     ```

2. **ã‚«ã‚¹ã‚¿ãƒ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦ãªã‚±ãƒ¼ã‚¹:**
   - å±æ€§ã®å‹å¤‰æ›´ï¼ˆä¾‹: String â†’ Dateï¼‰
   - ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—ã®å¤‰æ›´
   - è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿å¤‰æ›ãŒå¿…è¦ãªå ´åˆ
   - ã“ã®å ´åˆã¯`NSMigrationManager`ã¨`NSMappingModel`ã‚’ä½¿ç”¨

3. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥:**
   - Phase 1: è»½é‡ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã¿å®Ÿè£…
   - Phase 2ä»¥é™: å¿…è¦ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…
   - ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã‚’æ˜ç¢ºã«ç®¡ç†
   - å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã®ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–

4. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯:**
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‰ã«è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º

### 12.2 ãƒ‡ãƒ¼ã‚¿äº’æ›æ€§

- ãƒãƒ¼ã‚¸ãƒ§ãƒ³é–“ã®ãƒ‡ãƒ¼ã‚¿äº’æ›æ€§ã‚’ç¶­æŒ
- å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚‚èª­ã¿è¾¼ã¿å¯èƒ½ã«ã™ã‚‹
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸€æ–¹å‘ã®ã¿ï¼ˆãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ä¸å¯ï¼‰

---

## 13. å®Ÿè£…è¨ˆç”»

### 13.1 Phase 1: åŸºæœ¬æ©Ÿèƒ½
1. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®Ÿè£…
2. ã‚¿ã‚¹ã‚¯CRUDæ©Ÿèƒ½
3. é€šçŸ¥æ©Ÿèƒ½ï¼ˆã‚¢ãƒ©ãƒ¼ãƒ ãƒ»ãƒªãƒã‚¤ãƒ³ãƒ‰ï¼‰
4. åŸºæœ¬UIå®Ÿè£…

### 13.2 Phase 2: é«˜åº¦ãªæ©Ÿèƒ½
1. ã‚«ãƒ†ã‚´ãƒªæ©Ÿèƒ½
2. é‡è¦åº¦æ©Ÿèƒ½
3. ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯æ©Ÿèƒ½
4. è‡ªç„¶è¨€èªè§£ææ©Ÿèƒ½

### 13.3 Phase 3: æ‹¡å¼µæ©Ÿèƒ½
1. ã‚¿ã‚¹ã‚¯ç´°åˆ†åŒ–æ©Ÿèƒ½
2. ãƒ—ãƒªã‚»ãƒƒãƒˆæ™‚é–“æ©Ÿèƒ½
3. é€šçŸ¥ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
4. ç´°ã‹ã„UIèª¿æ•´

---

## 14. ä»˜éŒ²

### 14.1 ç”¨èªé›†
- **MVVM**: Model-View-ViewModelã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³
- **Core Data**: Appleã®ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **SwiftData**: iOS 17ä»¥é™ã®æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **UserNotifications**: iOSã®é€šçŸ¥ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **UNNotificationInterruptionLevel**: é€šçŸ¥ã®é‡è¦åº¦ãƒ¬ãƒ™ãƒ«

### 14.2 å‚è€ƒè³‡æ–™
- Apple Developer Documentation
- SwiftUI Documentation
- Core Data Programming Guide
- UserNotifications Framework Documentation

---

## 15. å°†æ¥ã‚¿ã‚¹ã‚¯

### 15.1 Notioné€£æºæ©Ÿèƒ½

#### 15.1.1 æ¦‚è¦
Notionã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ã¨Moriminderã®é€£å‹•ã‚’æ¤œè¨ã™ã‚‹ã€‚ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«å€‹åˆ¥ã®Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆãƒšãƒ¼ã‚¸ï¼‰ã‚’æŒ‡å®šã—ã¦é€£æºã§ãã‚‹æŸ”è»Ÿãªè¨­è¨ˆã¨ã™ã‚‹ã€‚

#### 15.1.2 æ¤œè¨äº‹é …
- **åŒæœŸæ–¹å‘**: åŒæ–¹å‘åŒæœŸï¼ˆMoriminder â†” Notionï¼‰ã¾ãŸã¯ä¸€æ–¹å‘åŒæœŸï¼ˆNotion â†’ Moriminderï¼‰
- **åŒæœŸå¯¾è±¡**: æŒ‡å®šã—ãŸã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ã€å€‹åˆ¥ã®Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆãƒšãƒ¼ã‚¸ï¼‰ã‚’æŒ‡å®šå¯èƒ½
- **èªè¨¼**: Notion APIã®èªè¨¼æ–¹æ³•ï¼ˆOAuthã€å†…éƒ¨çµ±åˆãƒˆãƒ¼ã‚¯ãƒ³ãªã©ï¼‰
- **ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°**: Moriminderã®ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿ã¨Notionã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®å¯¾å¿œé–¢ä¿‚
- **åŒæœŸã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã€æ‰‹å‹•åŒæœŸã€å®šæœŸçš„ãªè‡ªå‹•åŒæœŸ
- **ç«¶åˆè§£æ±º**: ä¸¡æ–¹ã§ç·¨é›†ã•ã‚ŒãŸå ´åˆã®å‡¦ç†æ–¹æ³•
- **å®Ÿè£…è¤‡é›‘åº¦**: ã‚„ã‚„è¤‡é›‘ã«ãªã‚‹è¦‹è¾¼ã¿ã®ãŸã‚ã€Phase 2ä»¥é™ã§æ¤œè¨

#### 15.1.3 å…·ä½“çš„ãªä½¿ç”¨ä¾‹ã¨æƒ³å®š

**åŸºæœ¬æ–¹é‡:**
- ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ã€Notionã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆãƒšãƒ¼ã‚¸ï¼‰ã‚’å€‹åˆ¥ã«æŒ‡å®šã§ãã‚‹
- é€£æºã‚’è¨­å®šã—ã¦ã„ãªã„ã‚«ãƒ†ã‚´ãƒªã¯ã€Notionã«å½±éŸ¿ã‚’ä¸ãˆãšãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ã§ç®¡ç†ã•ã‚Œã‚‹
- 1ã¤ã®ã‚«ãƒ†ã‚´ãƒªã«å¯¾ã—ã¦1ã¤ã®Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç´ä»˜ã‘å¯èƒ½

**å…·ä½“çš„ãªå‹•ä½œä¾‹:**

1. **ã‚«ãƒ†ã‚´ãƒªã¨Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç´ä»˜ã‘è¨­å®š**
   - ä¾‹: ã€Œä»•äº‹ã€ã‚«ãƒ†ã‚´ãƒª â†’ Notionã®ã€Œä»•äº‹ã‚¿ã‚¹ã‚¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
   - ä¾‹: ã€Œãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã€ã‚«ãƒ†ã‚´ãƒª â†’ é€£æºãªã—ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰
   - ä¾‹: ã€Œå®¶æ—ã€ã‚«ãƒ†ã‚´ãƒª â†’ Notionã®ã€Œå®¶æ—ã‚¿ã‚¹ã‚¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆåˆ¥ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰
   - è¨­å®šç”»é¢ã§ã€å„ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é¸æŠãƒ»è¨­å®šãŒå¯èƒ½

2. **Notion â†’ Moriminderï¼ˆå–ã‚Šè¾¼ã¿ï¼‰**
   - è¨­å®šã•ã‚ŒãŸNotionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã€æŒ‡å®šã—ãŸæ¡ä»¶ï¼ˆä¾‹: ç‰¹å®šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„ã‚¿ã‚°ï¼‰ã«è©²å½“ã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•çš„ã«å–ã‚Šè¾¼ã‚€
   - å–ã‚Šè¾¼ã¾ã‚ŒãŸã‚¿ã‚¹ã‚¯ã¯ã€å¯¾å¿œã™ã‚‹ã‚«ãƒ†ã‚´ãƒªã¨ã—ã¦è‡ªå‹•çš„ã«è¨­å®šã•ã‚Œã‚‹
   - ä¾‹: ã€Œä»•äº‹ã‚¿ã‚¹ã‚¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–ã‚Šè¾¼ã¾ã‚ŒãŸã‚¿ã‚¹ã‚¯ã¯ã€Œä»•äº‹ã€ã‚«ãƒ†ã‚´ãƒªã¨ã—ã¦è¨­å®šã•ã‚Œã‚‹
   - å–ã‚Šè¾¼ã¿ã¯å®šæœŸçš„ã«è‡ªå‹•å®Ÿè¡Œã€ã¾ãŸã¯æ‰‹å‹•ã§å®Ÿè¡Œå¯èƒ½

3. **Moriminder â†’ Notionï¼ˆçŠ¶æ…‹åæ˜ ï¼‰**
   - é€£æºè¨­å®šãŒã‚ã‚‹ã‚«ãƒ†ã‚´ãƒªã®ã‚¿ã‚¹ã‚¯ã‚’ã€Œé€²è¡Œä¸­ã€ã‚„ã€Œå®Œäº†ã€ã«å¤‰æ›´ã™ã‚‹ã¨ã€ç´ä»˜ã‘ã‚‰ã‚ŒãŸNotionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å¯¾å¿œã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚‚è‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã‚‹
   - ä¾‹: ã€Œä»•äº‹ã€ã‚«ãƒ†ã‚´ãƒªã®ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã«ã™ã‚‹ã¨ã€Notionã®ã€Œä»•äº‹ã‚¿ã‚¹ã‚¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è©²å½“ã‚¿ã‚¹ã‚¯ã‚‚å®Œäº†çŠ¶æ…‹ã«æ›´æ–°ã•ã‚Œã‚‹
   - é€£æºè¨­å®šãŒãªã„ã‚«ãƒ†ã‚´ãƒªã®ã‚¿ã‚¹ã‚¯ã¯ã€Notionã«é€ä¿¡ã•ã‚Œãªã„

4. **ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·**
   - é€£æºè¨­å®šãŒãªã„ã‚«ãƒ†ã‚´ãƒªï¼ˆä¾‹: ã€Œãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã€ãªã©ï¼‰ã®ã‚¿ã‚¹ã‚¯ã¯ã€Notionã«é€ä¿¡ã•ã‚Œãªã„
   - ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªã‚¿ã‚¹ã‚¯ã¯å®Œå…¨ã«ãƒ­ãƒ¼ã‚«ãƒ«ã§ç®¡ç†ã•ã‚Œã€Notionã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åæ˜ ã•ã‚Œã‚‹ã“ã¨ã¯ãªã„
   - ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«å€‹åˆ¥ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æŒ‡å®šã§ãã‚‹ãŸã‚ã€ä»•äº‹ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚’å®Œå…¨ã«åˆ†é›¢ã§ãã‚‹

**æƒ³å®šã•ã‚Œã‚‹å®Ÿè£…:**
- ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šæ©Ÿèƒ½
- ã‚«ãƒ†ã‚´ãƒªã¨Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®1å¯¾1ãƒãƒƒãƒ”ãƒ³ã‚°
- Notion APIã¨ã®åŒæ–¹å‘åŒæœŸï¼ˆè¨­å®šã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã®ã¿ï¼‰
- åŒæœŸè¨­å®šç”»é¢ã§ã€å„ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«Notioné€£æºã®æœ‰åŠ¹/ç„¡åŠ¹ã€å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€åŒæœŸé–“éš”ã‚’è¨­å®šå¯èƒ½
- ã‚«ãƒ†ã‚´ãƒªç®¡ç†ç”»é¢ã‹ã‚‰ã€Notioné€£æºè¨­å®šã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚‚å¯èƒ½

#### 15.1.4 å®Ÿè£…æ™‚ã®è€ƒæ…®äº‹é …
- Notion APIã®åˆ¶é™äº‹é …ï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãªã©ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã€APIã‚¨ãƒ©ãƒ¼ãªã©ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šï¼ˆã‚«ãƒ†ã‚´ãƒªã”ã¨ã®é€£æºæœ‰åŠ¹/ç„¡åŠ¹ã€å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é¸æŠã€åŒæœŸé–“éš”ãªã©ï¼‰
- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆAPIã‚­ãƒ¼ã®ç®¡ç†ã€ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã®æš—å·åŒ–ãªã©ï¼‰
- ã‚«ãƒ†ã‚´ãƒªã¨Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒãƒ”ãƒ³ã‚°ç®¡ç†ï¼ˆè¨­å®šã®ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ï¼‰
- Notionãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é¸æŠUIï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸€è¦§ã®å–å¾—ã¨è¡¨ç¤ºï¼‰
- ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤æ™‚ã®é€£æºè¨­å®šã®å‡¦ç†

---

## 16. å¤‰æ›´å±¥æ­´

| æ—¥æ™‚ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | å¤‰æ›´è€… |
|------|-----------|---------|--------|
| 2025-11-09 02:23 | 1.0 | åˆç‰ˆä½œæˆ | - |
| 2025-11-09 03:02 | 1.1 | ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«åŸºã¥ãä¿®æ­£:<br>- NotificationManager ã® criticalAlert è¦æ±‚ã‚’å‰Šé™¤ã€Time Sensitive ã«å¤‰æ›´<br>- iOSé€šçŸ¥64å€‹åˆ¶é™ã¸ã®å¯¾å¿œã‚’è¿½åŠ ï¼ˆå‹•çš„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ï¼‰<br>- ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ­ãƒ¼ãƒªãƒ³ã‚°ç”Ÿæˆæ–¹å¼ã«å…¨é¢æ”¹è¨‚<br>- RepeatPattern ã‚’ enum ã‹ã‚‰ struct ã«å¤‰æ›´<br>- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’æ‹¡å……ï¼ˆTaskErrorã€NotificationErrorã€APIErrorã€DataErrorï¼‰ | - |
| 2025-11-09 03:37 | 1.2 | ãƒ¬ãƒ“ãƒ¥ãƒ¼æŒ‡æ‘˜äº‹é …ã¸ã®å¯¾å¿œ:<br>- é€šçŸ¥æ•°ã®å„ªå…ˆåº¦ç®¡ç†ã‚’ä¿®æ­£ï¼ˆé«˜=15å€‹ã€ä¸­=10å€‹ã€ä½=5å€‹ï¼‰<br>- NotificationRefreshService ã«å„ªå…ˆåº¦ãƒ™ãƒ¼ã‚¹ã®å‰²ã‚Šå½“ã¦ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ <br>- RepeatPattern ã® Core Data ä¿å­˜æ–¹æ³•ã‚’æ˜è¨˜ï¼ˆTransformable å±æ€§ï¼‰<br>- ãƒ­ãƒ¼ãƒªãƒ³ã‚°ç”Ÿæˆæ–¹å¼ã®ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹å‡¦ç†ã‚’è©³ç´°åŒ–<br>- API ä½¿ç”¨é‡åˆ¶é™ã®è¿½è·¡æ–¹æ³•ã‚’å®Ÿè£…ï¼ˆUserDefaultsï¼‰<br>- BGTaskScheduler ã®æ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ˜è¨˜<br>- é€šçŸ¥ ID ã®å‘½åè¦å‰‡ã‚’æ˜ç¢ºåŒ–<br>- å¤šè¨€èªå¯¾å¿œã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚’è¿½åŠ <br>- Task ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã« lastSnoozeDateTime å±æ€§ã‚’è¿½åŠ  | - |
| 2025-11-09 15:44 | 1.3 | ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®šã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®ä¿®æ­£:<br>- ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®šã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ç¾åœ¨æ™‚åˆ»ã‹ã‚‰æœŸé™è¨­å®šã®æ™‚åˆ»ã«å¤‰æ›´<br>- AlarmSettingView ã« defaultDateTime ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ <br>- ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦ deadline ã¾ãŸã¯ startDateTime ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ä½¿ç”¨ | - |
| 2025-11-09 15:46 | 1.4 | æ—¥æ™‚è¨­å®šã®ä»»æ„é …ç›®ã¨ã—ã¦ã®å®Ÿè£…:<br>- DateSettingView ã«ãƒˆã‚°ãƒ«ã«ã‚ˆã‚‹æœ‰åŠ¹/ç„¡åŠ¹ã®åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ã‚’è¿½åŠ <br>- ãƒˆã‚°ãƒ«ãŒOFFã®å ´åˆã€æœŸé™/é–‹å§‹æ—¥æ™‚ã¯æœªè¨­å®šï¼ˆnilï¼‰ã®ã¾ã¾<br>- ãƒˆã‚°ãƒ«ãŒONã®å ´åˆã®ã¿DatePickerã‚’è¡¨ç¤º<br>- ãƒ—ãƒªã‚»ãƒƒãƒˆæ™‚é–“ãƒœã‚¿ãƒ³ã¯ãƒˆã‚°ãƒ«ãŒOFFã§ã‚‚è¡¨ç¤ºã•ã‚Œã€ã‚¿ãƒƒãƒ—ã§è‡ªå‹•çš„ã«ONã«ãªã‚‹ | - |

